<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>LEVEL UP: REBOOT | Health Sync</title>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        
        :root {
            --bg-dark: #050508; --panel-bg: rgba(15, 25, 40, 0.95);
            --text-main: #ffffff; --text-sub: #aaaaaa; --border-color: #333333;
            --neon-blue: #00d9ff; --neon-gold: #ffcc00; --neon-purple: #b53cff;
            --neon-red: #ff3c3c; --nav-bg: #0a0a10;
        }

        [data-theme="light"] {
            --bg-dark: #f4f5f7; --panel-bg: #ffffff;
            --text-main: #1a1a1a; --text-sub: #666666; --border-color: #dddddd;
            --neon-blue: #0066cc; --neon-gold: #d4a017; --neon-purple: #8a2be2;
            --neon-red: #dc3545; --nav-bg: #ffffff;
        }

        body {
            background-color: var(--bg-dark); color: var(--text-main);
            font-family: 'Pretendard', -apple-system, sans-serif;
            margin: 0; padding-top: env(safe-area-inset-top); padding-bottom: env(safe-area-inset-bottom); 
            display: flex; flex-direction: column; height: 100vh; height: 100dvh;
            box-sizing: border-box; overflow: hidden; transition: background-color 0.3s, color 0.3s;
        }

        header { padding: 15px 20px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; background: var(--panel-bg); z-index: 10; }
        #sys-title { font-weight: 900; letter-spacing: 1px; font-size: 1.1rem; }
        .level-badge { background: var(--neon-blue); color: #fff; font-weight: bold; padding: 4px 10px; border-radius: 4px; font-size: 0.8rem; transition: transform 0.3s; }

        main { flex-grow: 1; overflow-y: auto; padding: 20px; padding-bottom: calc(90px + env(safe-area-inset-bottom)); }
        .view-section { display: none; animation: fadeIn 0.3s ease; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        .system-card { background: var(--panel-bg); border: 1px solid var(--border-color); padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { font-size: 1.05rem; color: var(--neon-blue); margin-top: 0; margin-bottom: 15px; letter-spacing: 1px; text-transform: uppercase; }

        /* í”„ë¡œí•„ ë° í¬ì¸íŠ¸ ì˜ì—­ */
        .profile-box { display: flex; align-items: center; gap: 15px; margin-bottom: 10px; }
        .profile-image-container { position: relative; width: 65px; height: 65px; flex-shrink: 0; }
        .profile-img { width: 100%; height: 100%; border-radius: 50%; border: 2px solid var(--neon-blue); object-fit: cover; background: #222; }
        .upload-overlay { position: absolute; bottom: -5px; right: -5px; background: var(--neon-blue); width: 26px; height: 26px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 14px; cursor: pointer; border: 2px solid var(--bg-dark); }
        #imageUpload { display: none; }
        
        .title-badge { display: inline-block; padding: 3px 8px; font-size: 0.75rem; font-weight: bold; background: linear-gradient(45deg, rgba(181, 60, 255, 0.2), transparent); border: 1px solid var(--neon-purple); color: var(--neon-purple); border-radius: 4px; margin-bottom: 5px; }
        .btn-history { background: transparent; border: 1px solid var(--text-sub); color: var(--text-sub); font-size: 0.65rem; padding: 3px 6px; border-radius: 4px; cursor: pointer; margin-top: 5px; }
        
        .stat-summary { text-align: center; margin-bottom: 15px; background: linear-gradient(45deg, rgba(0,217,255,0.05), transparent); padding: 15px; border-radius: 8px; border: 1px solid rgba(0,217,255,0.2); }
        
        /* ë ˆë²¨ì—… íŒ¨ë„ */
        .levelup-panel { display: flex; justify-content: space-between; align-items: center; background: rgba(255, 204, 0, 0.05); border: 1px solid var(--neon-gold); padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .btn-primary { padding: 12px; background: var(--neon-blue); border: none; color: white; font-weight: bold; border-radius: 6px; cursor: pointer; transition: 0.2s; text-align: center; }
        .btn-primary:disabled { background: #555; color: #888; border-color: #444; cursor: not-allowed; }

        /* ë ˆì´ë” ì°¨íŠ¸ */
        .radar-chart-container { display: flex; justify-content: center; margin: 10px 0 20px 0; }
        .radar-chart { width: 100%; max-width: 200px; height: auto; aspect-ratio: 1/1; }
        .radar-bg-line { fill: none; stroke: var(--border-color); stroke-width: 0.8; }
        .radar-polygon { fill: rgba(0, 217, 255, 0.25); stroke: var(--neon-blue); stroke-width: 2; transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .radar-point { fill: var(--neon-blue); }
        .radar-label { fill: var(--text-sub); font-size: 7px; font-weight: bold; }
        .radar-value { fill: var(--neon-blue); font-size: 7px; font-weight: bold; }
        
        .stat-info { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.8rem; font-weight: 500;}
        .progress-bg { height: 6px; background: #2a2a2a; border-radius: 10px; overflow: hidden; margin-bottom: 12px; }
        .progress-fill { height: 100%; background: var(--neon-blue); box-shadow: 0 0 10px var(--neon-blue); transition: width 1s; width: 0%; }
        [data-theme="light"] .progress-bg { background: #e0e0e0; }

        /* í€˜ìŠ¤íŠ¸ ë° ìº˜ë¦°ë” */
        .quest-list-wrapper { max-height: 400px; overflow-y: auto; padding-right: 5px; }
        .quest-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 10px; border-bottom: 1px solid var(--border-color); cursor: pointer; transition: 0.2s; border-radius: 6px; }
        .quest-row:last-child { border-bottom: none; }
        .quest-stat-tag { font-size: 0.65rem; font-weight: bold; padding: 2px 5px; border-radius: 3px; margin-right: 8px; border: 1px solid var(--neon-blue); color: var(--neon-blue); }
        .quest-title { font-size: 0.9rem; font-weight: bold; margin-bottom: 3px; display: flex; align-items: center; }
        .quest-desc { font-size: 0.75rem; color: var(--text-sub); margin-left: 35px; }
        .quest-checkbox { width: 20px; height: 20px; border: 2px solid var(--neon-blue); border-radius: 50%; display: flex; justify-content: center; align-items: center; transition: 0.3s; }
        .quest-row.done { opacity: 0.5; }
        .quest-row.done .quest-title { text-decoration: line-through; }
        .quest-row.done .quest-checkbox { background: var(--neon-gold); border-color: var(--neon-gold); }
        .quest-row.done .quest-checkbox::after { content: "âœ“"; color: #000; font-size: 14px; font-weight: bold; }

        .calendar-wrapper { margin-top: 10px; }
        .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; font-size: 0.9rem; font-weight: bold; color: var(--neon-blue); }
        .cal-grid { display: flex; justify-content: space-between; gap: 5px; }
        .cal-day { flex: 1; text-align: center; padding: 10px 0; background: rgba(255,255,255,0.03); border-radius: 8px; border: 1px solid var(--border-color); }
        .cal-day.today { background: rgba(0, 217, 255, 0.1); border-color: var(--neon-blue); box-shadow: 0 0 10px rgba(0, 217, 255, 0.2); }
        .cal-name { font-size: 0.65rem; color: var(--text-sub); text-transform: uppercase; margin-bottom: 3px; }
        .cal-date { font-size: 1.1rem; font-weight: 900; color: var(--text-main); }
        .cal-score { font-size: 0.7rem; color: var(--neon-gold); margin-top: 5px; font-weight: bold; }

        /* ê¸°íƒ€ UI ê³µí†µ (ë˜ì „, ì†Œì…œ, ì„¤ì •) */
        .dungeon-banner { border: 1px solid var(--neon-red); background: rgba(255, 60, 60, 0.05); text-align: center; animation: pulse 2s infinite; }
        @keyframes pulse { 50% { border-color: rgba(255, 60, 60, 0.3); } }
        .map-container { width: 100%; height: 200px; border-radius: 8px; overflow: hidden; margin-bottom: 15px; border: 1px solid var(--border-color); }
        .map-container iframe { width: 100%; height: 100%; border: none; }
        
        .social-header { display: flex; gap: 10px; margin-bottom: 15px; }
        .social-tab-btn { flex: 1; padding: 10px; background: transparent; border: 1px solid var(--border-color); color: var(--text-sub); border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .social-tab-btn.active { background: rgba(0, 217, 255, 0.1); border-color: var(--neon-blue); color: var(--neon-blue); }
        .rank-tabs { display: flex; gap: 6px; margin-bottom: 15px; overflow-x: auto; padding-bottom: 8px; scrollbar-width: none; -ms-overflow-style: none; }
        .rank-tabs::-webkit-scrollbar { display: none; }
        .rank-tab-btn { white-space: nowrap; padding: 6px 12px; font-size: 0.75rem; background: transparent; border: 1px solid var(--border-color); color: var(--text-sub); border-radius: 20px; cursor: pointer; transition: 0.2s; flex-shrink: 0;}
        .rank-tab-btn.active { background: var(--neon-blue); color: #fff; border-color: var(--neon-blue); font-weight: bold;}
        .user-list { display: flex; flex-direction: column; gap: 10px; }
        .user-card { display: flex; align-items: center; justify-content: space-between; padding: 12px; background: rgba(255,255,255,0.02); border: 1px solid var(--border-color); border-radius: 8px; transition: 0.3s; }
        .user-card.my-rank { border-color: var(--neon-gold); background: rgba(255, 204, 0, 0.05); }
        .user-info { flex-grow: 1; margin-left: 12px; }
        .user-score { font-weight: 900; color: var(--neon-blue); font-size: 1.1rem; text-align: right; margin-right: 15px; }
        .btn-friend { padding: 5px 10px; font-size: 0.7rem; font-weight: bold; background: transparent; border: 1px solid var(--neon-blue); color: var(--neon-blue); border-radius: 4px; cursor: pointer; transition: 0.2s; }
        .btn-friend.added { background: var(--neon-blue); color: #fff; }

        .setting-row { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid var(--border-color); font-size: 0.95rem; }
        .setting-row:last-child { border-bottom: none; }
        .custom-select { background: transparent; color: var(--text-main); border: 1px solid var(--neon-blue); padding: 6px 10px; border-radius: 6px; font-family: inherit; font-size: 0.85rem; outline: none; cursor: pointer; -webkit-appearance: none; appearance: none; text-align: center; min-width: 90px; }
        .custom-select option { background: var(--bg-dark); color: var(--text-main); }
        [data-theme="light"] .custom-select { border-color: var(--border-color); color: var(--text-main); }
        [data-theme="light"] .custom-select option { background: #ffffff; color: #1a1a1a; }
        .switch { position: relative; width: 44px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #ccc; border-radius: 24px; transition: .4s; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background: white; border-radius: 50%; transition: .4s; }
        input:checked + .slider { background: var(--neon-blue); }
        input:checked + .slider:before { transform: translateX(20px); }

        nav { position: fixed; bottom: env(safe-area-inset-bottom); width: 100%; height: 70px; background: var(--nav-bg); display: flex; border-top: 1px solid var(--border-color); z-index: 10; }
        .nav-item { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 0.65rem; color: var(--text-sub); cursor: pointer; transition: color 0.2s; }
        .nav-item.active { color: var(--neon-blue); }
        .nav-icon { font-size: 1.3rem; margin-bottom: 4px; }

        /* ì¹­í˜¸ ëª¨ë‹¬ì°½ ìŠ¤íƒ€ì¼ */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 100; display: none; justify-content: center; align-items: center; backdrop-filter: blur(3px); }
        .modal-content { background: var(--panel-bg); border: 1px solid var(--neon-blue); padding: 25px; border-radius: 12px; width: 85%; max-height: 70vh; display: flex; flex-direction: column; box-shadow: 0 0 20px rgba(0, 217, 255, 0.2); }
        .modal-header { font-size: 1.2rem; font-weight: bold; color: var(--neon-blue); margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
        .modal-close { background: none; border: none; color: var(--text-sub); font-size: 1.5rem; cursor: pointer; }
        .history-list { overflow-y: auto; flex-grow: 1; }
        .history-item { padding: 12px 0; border-bottom: 1px dashed var(--border-color); display: flex; justify-content: space-between; align-items: center; }
        .history-item:last-child { border-bottom: none; }
        .hist-lvl { color: var(--neon-gold); font-weight: bold; font-size: 0.8rem; }
        .hist-title { color: var(--text-main); font-size: 0.95rem; font-weight: bold; }
    </style>
</head>
<body>

    <header>
        <div id="sys-title">LEVEL UP: REBOOT</div>
        <div class="level-badge" id="sys-level">Lv. 1</div>
    </header>

    <main>
        <section id="status" class="view-section active">
            <div class="profile-box">
                <div class="profile-image-container">
                    <img id="profilePreview" class="profile-img" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23555'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E">
                    <label for="imageUpload" class="upload-overlay">ğŸ“·</label>
                    <input type="file" id="imageUpload" accept="image/*" onchange="loadProfileImage(event)">
                </div>
                <div>
                    <div class="title-badge" id="prof-title-badge">ì² í•™í•˜ëŠ” ë§ˆë¼í† ë„ˆ</div>
                    <div style="font-size: 1.2rem; font-weight: bold;" data-i18n="prof_name">í”Œë ˆì´ì–´ (ë‚˜)</div>
                    <button class="btn-history" onclick="openTitleModal()" data-i18n="btn_hist">ì¹­í˜¸ ì´ë ¥ ì¡°íšŒ</button>
                </div>
            </div>

            <div class="levelup-panel">
                <div>
                    <div style="font-size: 0.75rem; color: var(--text-sub);" data-i18n="avail_pts">ë³´ìœ  í¬ì¸íŠ¸</div>
                    <div style="font-size: 1.6rem; font-weight: 900; color: var(--neon-gold);"><span id="display-pts">0</span><span style="font-size: 1rem;"> P</span></div>
                </div>
                <div style="text-align: right;">
                    <button id="btn-levelup" class="btn-primary" style="padding: 10px 20px; font-size: 0.9rem;" onclick="processLevelUp()" data-i18n="btn_lvlup">ë ˆë²¨ ì—…</button>
                    <div style="font-size: 0.7rem; color: var(--text-sub); margin-top: 5px;">
                        <span data-i18n="req_pts">ìš”êµ¬ëŸ‰:</span> <span id="display-req-pts">100</span> P
                    </div>
                </div>
            </div>

            <div class="stat-summary">
                <div style="font-size: 0.8rem; color: var(--text-sub);" data-i18n="tot_score">ì¢…í•© ìŠ¤ì½”ì–´</div>
                <div style="font-size: 2.2rem; font-weight: 900; color: var(--text-main); margin-top: 5px;" id="totalScore">0 <span style="font-size: 1rem; color: var(--neon-blue);">pts</span></div>
            </div>

            <div class="system-card">
                <h2 data-i18n="radar_title">Stat Radar</h2>
                <div class="radar-chart-container">
                    <svg class="radar-chart" viewBox="0 0 100 100" id="radarSvg">
                        <g id="radarGrid"></g>
                        <g id="radarAxes"></g>
                        <polygon id="playerPolygon" class="radar-polygon" points="" />
                        <g id="radarPoints"></g>
                        <g id="radarLabels"></g>
                    </svg>
                </div>
                
                <div style="margin-top: 10px;">
                    <div class="stat-info"><span data-i18n="bar_str">ê·¼ë ¥ (ë¬¼ë¦¬/ìš´ë™)</span><span style="color:var(--neon-blue)" id="barVal_str">0</span></div>
                    <div class="progress-bg"><div class="progress-fill" id="barFill_str"></div></div>
                    <div class="stat-info"><span data-i18n="bar_int">ì§€ëŠ¥ (í•™ìŠµ/ì¸ì§€)</span><span style="color:var(--neon-blue)" id="barVal_int">0</span></div>
                    <div class="progress-bg"><div class="progress-fill" id="barFill_int"></div></div>
                    <div class="stat-info"><span data-i18n="bar_cha">ë§¤ë ¥ (ì¸ë§¥/ì†Œí†µ)</span><span style="color:var(--neon-blue)" id="barVal_cha">0</span></div>
                    <div class="progress-bg"><div class="progress-fill" id="barFill_cha"></div></div>
                    <div class="stat-info"><span data-i18n="bar_vit">ì²´ë ¥ (ìˆ˜ë©´/íšŒë³µ)</span><span style="color:var(--neon-blue)" id="barVal_vit">0</span></div>
                    <div class="progress-bg"><div class="progress-fill" id="barFill_vit"></div></div>
                    <div class="stat-info"><span data-i18n="bar_wlth">ì¬ë ¥ (ìë³¸/íˆ¬ì)</span><span style="color:var(--neon-blue)" id="barVal_wlth">0</span></div>
                    <div class="progress-bg"><div class="progress-fill" id="barFill_wlth"></div></div>
                    <div class="stat-info"><span data-i18n="bar_agi">ë¯¼ì²© (ì‹œê°„/íš¨ìœ¨)</span><span style="color:var(--neon-blue)" id="barVal_agi">0</span></div>
                    <div class="progress-bg"><div class="progress-fill" id="barFill_agi"></div></div>
                </div>
            </div>
        </section>

        <section id="quests" class="view-section">
            <h2 data-i18n="quest_title">Daily Quests</h2>
            <div style="font-size:0.75rem; color:var(--neon-gold); text-align:right; margin-bottom:10px;" data-i18n="quest_hint">â€» í€˜ìŠ¤íŠ¸ ì™„ë£Œ ì‹œ +20P íšë“</div>
            <div class="system-card">
                <div class="quest-list-wrapper" id="quest-list-container"></div>
            </div>
            <div class="system-card calendar-wrapper">
                <div class="cal-header">
                    <span data-i18n="cal_title">ì£¼ê°„ ì§„ì²™ë„</span>
                    <span style="font-size:0.8rem; color:var(--text-sub);" id="cal-month"></span>
                </div>
                <div class="cal-grid" id="calendar-grid"></div>
            </div>
        </section>

        <section id="dungeon" class="view-section">
            <h2 data-i18n="raid_title">Local Raid</h2>
            <div class="system-card dungeon-banner">
                <h3 style="color: var(--neon-red); margin: 0 0 10px 0; font-size:1.2rem;" data-i18n="raid_boss">âš ï¸ ì„œìš¸ ê°•ë‚¨ ì—°í•© ë³´ìŠ¤ ì¶œí˜„</h3>
                <div class="map-container">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3164.8872958213665!2d127.02498261564757!3d37.49805097981048!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x357ca1598c471015%3A0x6b0d1e57c631a3!2z6rCV64Ko7Jet!5e0!3m2!1sko!2skr!4v1690000000000!5m2!1sko!2skr" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
                <p style="font-size: 0.85rem; color: var(--text-main); margin-bottom: 5px;" data-i18n="raid_desc1">"í‡´ê·¼ê¸¸ì˜ ìœ í˜¹ì"ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                <p style="font-size: 0.75rem; color: var(--text-sub);" data-i18n="raid_desc2">ê·¼ì²˜ì˜ í—Œí„°ë“¤ê³¼ ì—°í•©í•˜ì—¬ 2ì‹œê°„ ë‚´<br>í•©ì‚° 50kmë¥¼ ë‹¬ì„±í•˜ê³  ì „ë¦¬í’ˆì„ íšë“í•˜ì„¸ìš”.</p>
                <div style="font-size: 0.8rem; margin: 15px 0; font-weight:bold;"><span data-i18n="raid_part">í˜„ì¬ ì°¸ì—¬ ì¸ì›: </span><span style="color:var(--neon-blue)">4</span> / 10</div>
                <button class="btn-primary" style="background: var(--neon-red);" data-i18n="raid_btn">ë ˆì´ë“œ ì…ì¥í•˜ê¸°</button>
            </div>
        </section>

        <section id="social" class="view-section">
            <div class="social-header">
                <button class="social-tab-btn active" onclick="toggleSocialMode('global', this)" data-i18n="soc_global">ğŸ† ê¸€ë¡œë²Œ ë­í‚¹</button>
                <button class="social-tab-btn" onclick="toggleSocialMode('friends', this)" data-i18n="soc_friend">ğŸ‘¥ ë‚´ ì¹œêµ¬</button>
            </div>
            <div id="ranking-controls" class="rank-tabs">
                <button class="rank-tab-btn active" onclick="renderUsers('total', this)" data-i18n="sort_tot">ì¢…í•©ìŠ¤ì½”ì–´</button>
                <button class="rank-tab-btn" onclick="renderUsers('str', this)" data-i18n="sort_str">ê·¼ë ¥</button>
                <button class="rank-tab-btn" onclick="renderUsers('int', this)" data-i18n="sort_int">ì§€ëŠ¥</button>
                <button class="rank-tab-btn" onclick="renderUsers('cha', this)" data-i18n="sort_cha">ë§¤ë ¥</button>
                <button class="rank-tab-btn" onclick="renderUsers('vit', this)" data-i18n="sort_vit">ì²´ë ¥</button>
                <button class="rank-tab-btn" onclick="renderUsers('wlth', this)" data-i18n="sort_wlth">ì¬ë ¥</button>
                <button class="rank-tab-btn" onclick="renderUsers('agi', this)" data-i18n="sort_agi">ë¯¼ì²©</button>
            </div>
            <div class="user-list" id="user-list-container"></div>
        </section>

        <section id="settings" class="view-section">
            <h2 data-i18n="set_title">System Settings</h2>
            <div class="system-card">
                <div class="setting-row">
                    <span data-i18n="set_lang">ì–¸ì–´ (Language)</span>
                    <select class="custom-select" onchange="changeLanguage(this.value)">
                        <option value="ko" selected>í•œêµ­ì–´</option>
                        <option value="en">English</option>
                        <option value="ja">æ—¥æœ¬èª</option>
                    </select>
                </div>
                <div class="setting-row">
                    <span data-i18n="set_theme">ë¼ì´íŠ¸ ëª¨ë“œ</span>
                    <label class="switch"><input type="checkbox" id="theme-toggle" onchange="changeTheme()"><span class="slider"></span></label>
                </div>
                <div class="setting-row">
                    <span data-i18n="set_push">í‘¸ì‹œ ì•Œë¦¼ ìˆ˜ì‹ </span>
                    <label class="switch"><input type="checkbox" checked><span class="slider"></span></label>
                </div>
            </div>
            <div class="system-card">
                <div class="setting-row">
                    <span data-i18n="set_gps">ì•± ì‹¤í–‰ ì‹œ í˜„ìœ„ì¹˜ íƒìƒ‰</span>
                    <label class="switch"><input type="checkbox" id="gps-toggle" onchange="toggleGPS()"><span class="slider"></span></label>
                </div>
                <div class="setting-row" id="gps-status" style="font-size:0.75rem; color:var(--text-sub); display:none; justify-content:flex-end; padding-top:0;">
                    ìœ„ì¹˜ ì •ë³´ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...
                </div>
                
                <div class="setting-row">
                    <span data-i18n="set_sync">ì‚¼ì„± í—¬ìŠ¤ / ê±´ê°• ì•± ë™ê¸°í™”</span>
                    <label class="switch"><input type="checkbox" id="sync-toggle" onchange="toggleHealthSync()"><span class="slider"></span></label>
                </div>
                <div class="setting-row" id="sync-status" style="font-size:0.75rem; color:var(--neon-blue); display:none; justify-content:flex-end; padding-top:0; text-align:right;">
                </div>
            </div>
            <button class="btn-primary" style="background: #222; border: 1px solid var(--border-color); color: var(--neon-red);" data-i18n="set_logout">ë¡œê·¸ì•„ì›ƒ</button>
        </section>
    </main>

    <nav>
        <div class="nav-item active" onclick="switchTab('status', this)"><span class="nav-icon">ğŸ‘¤</span><span data-i18n="nav_status">ìƒíƒœì°½</span></div>
        <div class="nav-item" onclick="switchTab('quests', this)"><span class="nav-icon">ğŸ“œ</span><span data-i18n="nav_quest">í€˜ìŠ¤íŠ¸</span></div>
        <div class="nav-item" onclick="switchTab('dungeon', this)"><span class="nav-icon">âš”ï¸</span><span data-i18n="nav_dungeon">ë˜ì „</span></div>
        <div class="nav-item" onclick="switchTab('social', this)"><span class="nav-icon">ğŸ†</span><span data-i18n="nav_social">ì†Œì…œ</span></div>
        <div class="nav-item" onclick="switchTab('settings', this)"><span class="nav-icon">âš™ï¸</span><span data-i18n="nav_settings">ì„¤ì •</span></div>
    </nav>

    <div class="modal-overlay" id="titleModal">
        <div class="modal-content">
            <div class="modal-header">
                <span data-i18n="modal_title">ì¹­í˜¸ ì´ë ¥ ì¡°íšŒ</span>
                <button class="modal-close" onclick="closeTitleModal()">Ã—</button>
            </div>
            <div class="history-list" id="history-list-container">
                </div>
        </div>
    </div>

    <script>
        // --- 1. i18n Dictionary & Title Vocab ---
        const i18n = {
            ko: {
                nav_status: "ìƒíƒœì°½", nav_quest: "í€˜ìŠ¤íŠ¸", nav_dungeon: "ë˜ì „", nav_social: "ì†Œì…œ", nav_settings: "ì„¤ì •",
                prof_name: "í”Œë ˆì´ì–´ (ë‚˜)", btn_hist: "ì¹­í˜¸ ì´ë ¥ ì¡°íšŒ", avail_pts: "ë³´ìœ  í¬ì¸íŠ¸", btn_lvlup: "ë ˆë²¨ ì—…", req_pts: "ìš”êµ¬ëŸ‰:",
                tot_score: "ì¢…í•© ìŠ¤ì½”ì–´", radar_title: "Stat Radar", 
                str: "ê·¼ë ¥", int: "ì§€ëŠ¥", cha: "ë§¤ë ¥", vit: "ì²´ë ¥", wlth: "ì¬ë ¥", agi: "ë¯¼ì²©",
                bar_str: "ê·¼ë ¥ (ë¬¼ë¦¬/ìš´ë™)", bar_int: "ì§€ëŠ¥ (í•™ìŠµ/ì¸ì§€)", bar_cha: "ë§¤ë ¥ (ì¸ë§¥/ì†Œí†µ)", bar_vit: "ì²´ë ¥ (ìˆ˜ë©´/íšŒë³µ)", bar_wlth: "ì¬ë ¥ (ìë³¸/íˆ¬ì)", bar_agi: "ë¯¼ì²© (ì‹œê°„/íš¨ìœ¨)",
                quest_title: "Daily Quests", quest_hint: "â€» í€˜ìŠ¤íŠ¸ ì™„ë£Œ ì‹œ +20P íšë“", cal_title: "ì£¼ê°„ ì§„ì²™ë„",
                raid_title: "Local Raid", raid_boss: "âš ï¸ ì„œìš¸ ê°•ë‚¨ ì—°í•© ë³´ìŠ¤ ì¶œí˜„", raid_desc1: '"í‡´ê·¼ê¸¸ì˜ ìœ í˜¹ì"ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.', raid_desc2: "ê·¼ì²˜ í—Œí„°ë“¤ê³¼ ì—°í•©í•˜ì—¬ 2ì‹œê°„ ë‚´<br>í•©ì‚° 50kmë¥¼ ë‹¬ì„±í•˜ê³  ì „ë¦¬í’ˆì„ íšë“í•˜ì„¸ìš”.", raid_part: "ì°¸ì—¬ ì¸ì›: ", raid_btn: "ë ˆì´ë“œ ì…ì¥í•˜ê¸°",
                soc_global: "ğŸ† ê¸€ë¡œë²Œ ë­í‚¹", soc_friend: "ğŸ‘¥ ë‚´ ì¹œêµ¬", sort_tot: "ì¢…í•©ìŠ¤ì½”ì–´", sort_str: "ê·¼ë ¥", sort_int: "ì§€ëŠ¥", sort_cha: "ë§¤ë ¥", sort_vit: "ì²´ë ¥", sort_wlth: "ì¬ë ¥", sort_agi: "ë¯¼ì²©",
                set_title: "System Settings", set_lang: "ì–¸ì–´ (Language)", set_theme: "ë¼ì´íŠ¸ ëª¨ë“œ", set_push: "í‘¸ì‹œ ì•Œë¦¼ ìˆ˜ì‹ ", set_gps: "ì•± ì‹¤í–‰ ì‹œ í˜„ìœ„ì¹˜ íƒìƒ‰", set_sync: "ê±´ê°• ì•±(Health) ë™ê¸°í™”", set_logout: "ë¡œê·¸ì•„ì›ƒ",
                no_friend: "ë“±ë¡ëœ ì¹œêµ¬ê°€ ì—†ìŠµë‹ˆë‹¤.", btn_add: "ì¹œêµ¬ ì¶”ê°€", btn_added: "ì¹œêµ¬ âœ“", gps_on: "ìœ„ì¹˜ ê¶Œí•œ í™œì„±í™”ë¨", gps_off: "ìœ„ì¹˜ íƒìƒ‰ ì¤‘ì§€ë¨", gps_err: "ìœ„ì¹˜ ì •ë³´ ì˜¤ë¥˜", modal_title: "ì¹­í˜¸ ì´ë ¥ ì¡°íšŒ",
                sync_req: "í—¬ìŠ¤ ì»¤ë„¥íŠ¸ ê¶Œí•œ ìš”ì²­ ì¤‘...", sync_done: "ë™ê¸°í™” ì™„ë£Œ:<br>10,234ë³´ / ìˆ˜ë©´ 7.5h (ê·¼ë ¥/ì²´ë ¥ ìƒìŠ¹!)", sync_off: "ë™ê¸°í™”ê°€ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤."
            },
            en: {
                nav_status: "Status", nav_quest: "Quests", nav_dungeon: "Dungeon", nav_social: "Social", nav_settings: "Settings",
                prof_name: "Player (Me)", btn_hist: "Title History", avail_pts: "Available Pts", btn_lvlup: "Level Up", req_pts: "Required:",
                tot_score: "Total Score", radar_title: "Stat Radar", 
                str: "STR", int: "INT", cha: "CHA", vit: "VIT", wlth: "WLTH", agi: "AGI",
                bar_str: "STR (Physical/Workout)", bar_int: "INT (Study/Cognition)", bar_cha: "CHA (Network/Comm)", bar_vit: "VIT (Sleep/Recovery)", bar_wlth: "WLTH (Capital/Invest)", bar_agi: "AGI (Time/Efficiency)",
                quest_title: "Daily Quests", quest_hint: "â€» Complete quest to earn +20P", cal_title: "Weekly Progress",
                raid_title: "Local Raid", raid_boss: "âš ï¸ Gangnam Alliance Boss", raid_desc1: '"Predator of Laziness" detected.', raid_desc2: "Unite with nearby hunters to achieve<br>50km in 2 hours and get loot.", raid_part: "Participants: ", raid_btn: "Enter Raid",
                soc_global: "ğŸ† Global Rank", soc_friend: "ğŸ‘¥ My Friends", sort_tot: "Total", sort_str: "STR", sort_int: "INT", sort_cha: "CHA", sort_vit: "VIT", sort_wlth: "WLTH", sort_agi: "AGI",
                set_title: "System Settings", set_lang: "Language", set_theme: "Light Theme", set_push: "Push Notifications", set_gps: "Auto Location Tracking", set_sync: "Sync Health App Data", set_logout: "Logout",
                no_friend: "No friends registered.", btn_add: "Add Friend", btn_added: "Friend âœ“", gps_on: "Location tracking on", gps_off: "Location tracking off", gps_err: "Location Error", modal_title: "Title History",
                sync_req: "Requesting Health Connect...", sync_done: "Sync Complete:<br>10,234 steps / 7.5h sleep (STR/VIT up!)", sync_off: "Sync disabled."
            },
            ja: {
                nav_status: "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹", nav_quest: "ã‚¯ã‚¨ã‚¹ãƒˆ", nav_dungeon: "ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³", nav_social: "ã‚½ãƒ¼ã‚·ãƒ£ãƒ«", nav_settings: "è¨­å®š",
                prof_name: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ (ç§)", btn_hist: "ç§°å·å±¥æ­´", avail_pts: "ä¿æœ‰ãƒã‚¤ãƒ³ãƒˆ", btn_lvlup: "ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—", req_pts: "å¿…è¦é‡:",
                tot_score: "ç·åˆã‚¹ã‚³ã‚¢", radar_title: "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ãƒ¼ãƒ€ãƒ¼", 
                str: "ç­‹åŠ›", int: "çŸ¥èƒ½", cha: "é­…åŠ›", vit: "ä½“åŠ›", wlth: "è²¡åŠ›", agi: "æ•æ·",
                bar_str: "ç­‹åŠ› (ç‰©ç†/é‹å‹•)", bar_int: "çŸ¥èƒ½ (å­¦ç¿’/èªçŸ¥)", bar_cha: "é­…åŠ› (äººè„ˆ/ç–é€š)", bar_vit: "ä½“åŠ› (ç¡çœ /å›å¾©)", bar_wlth: "è²¡åŠ› (è³‡æœ¬/æŠ•è³‡)", bar_agi: "æ•æ· (æ™‚é–“/åŠ¹ç‡)",
                quest_title: "ãƒ‡ã‚¤ãƒªãƒ¼ã‚¯ã‚¨ã‚¹ãƒˆ", quest_hint: "â€» ã‚¯ã‚¨ã‚¹ãƒˆå®Œäº†æ™‚ +20P ç²å¾—", cal_title: "é€±é–“é€²æ—åº¦",
                raid_title: "ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¬ã‚¤ãƒ‰", raid_boss: "âš ï¸ æ±Ÿå—é€£åˆãƒœã‚¹å‡ºç¾", raid_desc1: "ã€Œæ€ æƒ°ã®æ•é£Ÿè€…ã€æ„ŸçŸ¥ã€‚", raid_desc2: "è¿‘ãã®ãƒãƒ³ã‚¿ãƒ¼ã¨é€£åˆã—ã¦2æ™‚é–“ä»¥å†…ã«<br>åˆè¨ˆ50kmã‚’é”æˆã—æˆ¦åˆ©å“ã‚’ç²å¾—ã›ã‚ˆã€‚", raid_part: "å‚åŠ äººæ•°: ", raid_btn: "å…¥å ´ã™ã‚‹",
                soc_global: "ğŸ† ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ©ãƒ³ã‚¯", soc_friend: "ğŸ‘¥ ãƒã‚¤ãƒ•ãƒ¬ãƒ³ãƒ‰", sort_tot: "ç·åˆ", sort_str: "ç­‹åŠ›", sort_int: "çŸ¥èƒ½", sort_cha: "é­…åŠ›", sort_vit: "ä½“åŠ›", sort_wlth: "è²¡åŠ›", sort_agi: "æ•æ·",
                set_title: "ã‚·ã‚¹ãƒ†ãƒ è¨­å®š", set_lang: "è¨€èª (Language)", set_theme: "ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰", set_push: "ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥å—ä¿¡", set_gps: "èµ·å‹•æ™‚ã®ä½ç½®æƒ…å ±å–å¾—", set_sync: "ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢ã‚¢ãƒ—ãƒªåŒæœŸ", set_logout: "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ",
                no_friend: "å‹é”ãŒã„ã¾ã›ã‚“ã€‚", btn_add: "å‹é”è¿½åŠ ", btn_added: "å‹é” âœ“", gps_on: "ä½ç½®æƒ…å ±æœ‰åŠ¹", gps_off: "ä½ç½®æƒ…å ±åœæ­¢", gps_err: "ä½ç½®æƒ…å ±ã‚¨ãƒ©ãƒ¼", modal_title: "ç§°å·å±¥æ­´",
                sync_req: "ãƒ˜ãƒ«ã‚¹æ¨©é™ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¸­...", sync_done: "åŒæœŸå®Œäº†:<br>10,234æ­© / ç¡çœ 7.5h (ç­‹åŠ›ãƒ»ä½“åŠ›UP!)", sync_off: "åŒæœŸãŒè§£é™¤ã•ã‚Œã¾ã—ãŸã€‚"
            }
        };

        // ì¸ë””ì–¸ì‹ í˜¸ì¹­ ë°ì´í„° í’€ (1ìœ„ í˜•ìš©ì‚¬ + 2ìœ„ ëª…ì‚¬)
        const titleVocab = {
            str: { ko: { pre: ["ê°•ì¸í•œ", "ê±°ì¹œ", "ë¶€ì„œì§€ì§€ ì•ŠëŠ”"], suf: ["ê³°", "ë°”ìœ„", "ê±°ì¸"] }, en: { pre: ["Strong", "Tough", "Unbreakable"], suf: ["Bear", "Rock", "Giant"] }, ja: { pre: ["å¼·é­ãª", "è’ã€…ã—ã„", "ç •ã‘ãªã„"], suf: ["ç†Š", "å²©", "å·¨äºº"] } },
            int: { ko: { pre: ["ì§€í˜œë¡œìš´", "ê¿°ëš«ì–´ë³´ëŠ”", "ê¹Šì€"], suf: ["ì˜¬ë¹¼ë¯¸", "í˜¸ìˆ˜", "í˜„ì"] }, en: { pre: ["Wise", "Piercing", "Deep"], suf: ["Owl", "Lake", "Sage"] }, ja: { pre: ["çŸ¥æµã®ã‚ã‚‹", "è¦‹æŠœã", "æ·±ã„"], suf: ["ãƒ•ã‚¯ãƒ­ã‚¦", "æ¹–", "è³¢è€…"] } },
            cha: { ko: { pre: ["ë§¤í˜¹ì ì¸", "ë¹›ë‚˜ëŠ”", "ì‚¬ëŒì„ ë„ëŠ”"], suf: ["ì—¬ìš°", "ë¶ˆê½ƒ", "ë³„"] }, en: { pre: ["Charming", "Shining", "Magnetic"], suf: ["Fox", "Flame", "Star"] }, ja: { pre: ["é­…åŠ›çš„ãª", "è¼ã", "æƒ¹ãã¤ã‘ã‚‹"], suf: ["ã‚­ãƒ„ãƒ", "ç‚", "æ˜Ÿ"] } },
            vit: { ko: { pre: ["ì§€ì¹˜ì§€ ì•ŠëŠ”", "ëˆì§ˆê¸´", "ìˆ¨ì‰¬ëŠ”"], suf: ["ê±°ë¶ì´", "ëŒ€ì§€", "ë¿Œë¦¬"] }, en: { pre: ["Tireless", "Persistent", "Breathing"], suf: ["Turtle", "Earth", "Root"] }, ja: { pre: ["ç–²ã‚Œãªã„", "ç²˜ã‚Šå¼·ã„", "æ¯ã¥ã"], suf: ["äº€", "å¤§åœ°", "æ ¹"] } },
            wlth:{ ko: { pre: ["í’ì¡±í•œ", "í™©ê¸ˆì„ ì¥”", "ê³„ì‚°í•˜ëŠ”"], suf: ["ë‘êº¼ë¹„", "íƒœì–‘", "ë³´ì„"] }, en: { pre: ["Abundant", "Golden", "Calculating"], suf: ["Toad", "Sun", "Gem"] }, ja: { pre: ["è±Šã‹ãª", "é»„é‡‘ã‚’æ¡ã‚‹", "è¨ˆç®—ã™ã‚‹"], suf: ["ãƒ’ã‚­ã‚¬ã‚¨ãƒ«", "å¤ªé™½", "å®çŸ³"] } },
            agi: { ko: { pre: ["ë‚ ìŒ˜", "ë°”ëŒì„ ê°€ë¥´ëŠ”", "ë³´ì´ì§€ ì•ŠëŠ”"], suf: ["í‘œë²”", "í™”ì‚´", "ë§¤"] }, en: { pre: ["Swift", "Wind-cleaving", "Unseen"], suf: ["Panther", "Arrow", "Hawk"] }, ja: { pre: ["ç´ æ—©ã„", "é¢¨ã‚’åˆ‡ã‚‹", "è¦‹ãˆãªã„"], suf: ["ãƒ’ãƒ§ã‚¦", "çŸ¢", "é·¹"] } }
        };

        // --- 2. ì‹œìŠ¤í…œ ìƒíƒœ ë³€ìˆ˜ (ë ˆë²¨ì—… ë° ì¹­í˜¸) ---
        let currentLang = 'ko';
        let userLevel = 1;
        let userPoints = 150; 
        let titleHistory = [
            { level: 1, title: { ko: "ìƒˆë‚´ê¸° í—Œí„°", en: "Novice Hunter", ja: "æ–°ç±³ãƒãƒ³ã‚¿ãƒ¼" } }
        ];

        const statKeys = ['str', 'int', 'cha', 'vit', 'wlth', 'agi'];
        const myStats = { str: 82, int: 70, cha: 65, vit: 85, wlth: 55, agi: 45 };

        // í•„ìš” í¬ì¸íŠ¸ ì§€ìˆ˜ ì¦ê°€ ê³µì‹: 100 * (1.5 ^ (ë ˆë²¨-1))
        function getReqPoints(level) { return Math.floor(100 * Math.pow(1.5, level - 1)); }

        function updatePointUI() {
            const reqPts = getReqPoints(userLevel);
            document.getElementById('sys-level').innerText = `Lv. ${userLevel}`;
            document.getElementById('display-pts').innerText = userPoints;
            document.getElementById('display-req-pts').innerText = reqPts;
            
            const btn = document.getElementById('btn-levelup');
            if(userPoints >= reqPts) {
                btn.disabled = false;
                btn.style.background = "var(--neon-gold)";
                btn.style.color = "black";
                btn.style.boxShadow = "0 0 15px var(--neon-gold)";
            } else {
                btn.disabled = true;
                btn.style.background = "#333";
                btn.style.color = "#888";
                btn.style.boxShadow = "none";
            }
            
            const latestTitle = titleHistory[titleHistory.length - 1].title[currentLang];
            document.getElementById('prof-title-badge').innerText = latestTitle;
        }

        function generateTitle() {
            let sortedStats = statKeys.map(k => ({ key: k, val: myStats[k] })).sort((a, b) => b.val - a.val);
            const top1 = sortedStats[0].key; 
            const top2 = sortedStats[1].key; 
            const randPre = Math.floor(Math.random() * 3);
            const randSuf = Math.floor(Math.random() * 3);
            return {
                ko: `${titleVocab[top1].ko.pre[randPre]} ${titleVocab[top2].ko.suf[randSuf]}`,
                en: `${titleVocab[top1].en.pre[randPre]} ${titleVocab[top2].en.suf[randSuf]}`,
                ja: `${titleVocab[top1].ja.pre[randPre]} ${titleVocab[top2].ja.suf[randSuf]}`
            };
        }

        function processLevelUp() {
            const reqPts = getReqPoints(userLevel);
            if(userPoints >= reqPts) {
                userPoints -= reqPts;
                userLevel++;
                const newTitleObj = generateTitle();
                titleHistory.push({ level: userLevel, title: newTitleObj });
                myStats.str = Math.min(100, myStats.str + Math.floor(Math.random()*3));
                myStats.vit = Math.min(100, myStats.vit + Math.floor(Math.random()*3));

                updatePointUI(); drawRadarChart(); renderHistoryModal();
                alert(`Level Up! [Lv.${userLevel}]\nìƒˆë¡œìš´ ì¹­í˜¸ íšë“: ${newTitleObj[currentLang]}`);
            }
        }

        function openTitleModal() { renderHistoryModal(); document.getElementById('titleModal').style.display = 'flex'; }
        function closeTitleModal() { document.getElementById('titleModal').style.display = 'none'; }
        function renderHistoryModal() {
            const container = document.getElementById('history-list-container');
            container.innerHTML = '';
            [...titleHistory].reverse().forEach(hist => {
                const item = document.createElement('div');
                item.className = 'history-item';
                item.innerHTML = `<span class="hist-lvl">Lv. ${hist.level}</span><span class="hist-title">${hist.title[currentLang]}</span>`;
                container.appendChild(item);
            });
        }

        // --- 3. íƒ­ ë° ì‹œìŠ¤í…œ, ì–¸ì–´ í•¨ìˆ˜ ---
        function changeLanguage(langCode) {
            currentLang = langCode;
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (i18n[currentLang][key]) el.innerHTML = i18n[currentLang][key];
            });
            drawRadarChart(); renderUsers(currentSortCriteria); renderQuestList(); updatePointUI();
            if(document.getElementById('titleModal').style.display === 'flex') renderHistoryModal();
            
            // Toggle texts update
            if(document.getElementById('gps-toggle').checked) document.getElementById('gps-status').innerHTML = `<span style="color:var(--neon-blue);">${i18n[currentLang].gps_on}</span>`;
            if(document.getElementById('sync-toggle').checked) document.getElementById('sync-status').innerHTML = `<span style="color:var(--neon-blue);">${i18n[currentLang].sync_done}</span>`;
        }

        function switchTab(tabId, el) {
            document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
            if(tabId === 'social') renderUsers(currentSortCriteria);
            if(tabId === 'status') { drawRadarChart(); updatePointUI(); }
            if(tabId === 'quests') { renderQuestList(); renderCalendar(); }
        }

        function changeTheme() {
            const isLight = document.getElementById('theme-toggle').checked;
            document.documentElement.setAttribute('data-theme', isLight ? 'light' : '');
            let themeMeta = document.querySelector('meta[name="theme-color"]') || document.createElement('meta');
            themeMeta.name = "theme-color"; themeMeta.content = isLight ? "#ffffff" : "#050508";
            document.head.appendChild(themeMeta);
        }

        function loadProfileImage(event) {
            const output = document.getElementById('profilePreview');
            if (event.target.files[0]) output.src = URL.createObjectURL(event.target.files[0]);
        }

        // --- 4. ë ˆì´ë” ì°¨íŠ¸ ë Œë”ë§ ---
        function drawRadarChart() {
            const centerX = 50, centerY = 50, radius = 33; 
            const angles = [];
            for(let i=0; i<6; i++) angles.push(-Math.PI / 2 + (i * Math.PI / 3));

            const gridGroup = document.getElementById('radarGrid');
            const axesGroup = document.getElementById('radarAxes');
            gridGroup.innerHTML = ''; axesGroup.innerHTML = '';
            
            for (let level = 1; level <= 5; level++) {
                const r = radius * (level / 5); let points = "";
                for (let i = 0; i < 6; i++) points += `${centerX + r * Math.cos(angles[i])},${centerY + r * Math.sin(angles[i])} `;
                const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                polygon.setAttribute('points', points.trim()); polygon.setAttribute('class', 'radar-bg-line');
                gridGroup.appendChild(polygon);
            }

            for (let i = 0; i < 6; i++) {
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', centerX); line.setAttribute('y1', centerY);
                line.setAttribute('x2', centerX + radius * Math.cos(angles[i])); line.setAttribute('y2', centerY + radius * Math.sin(angles[i]));
                line.setAttribute('class', 'radar-bg-line');
                axesGroup.appendChild(line);
            }

            let dataPoints = "";
            const pointsGroup = document.getElementById('radarPoints');
            const labelsGroup = document.getElementById('radarLabels');
            pointsGroup.innerHTML = ''; labelsGroup.innerHTML = '';

            let totalSum = 0;
            for (let i = 0; i < 6; i++) {
                const key = statKeys[i]; const val = myStats[key]; totalSum += val;
                const r = radius * (val / 100);
                const x = centerX + r * Math.cos(angles[i]); const y = centerY + r * Math.sin(angles[i]);
                dataPoints += `${x},${y} `;

                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', x); circle.setAttribute('cy', y); circle.setAttribute('r', '1.2'); circle.setAttribute('class', 'radar-point');
                pointsGroup.appendChild(circle);

                const labelRadius = radius + 9; 
                const lx = centerX + labelRadius * Math.cos(angles[i]); const ly = centerY + labelRadius * Math.sin(angles[i]) + 2; 

                let anchor = "middle"; if(i===1 || i===2) anchor = "start"; if(i===4 || i===5) anchor = "end";   

                const textName = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                textName.setAttribute('x', lx); textName.setAttribute('y', ly - 3);
                textName.setAttribute('text-anchor', anchor); textName.setAttribute('class', 'radar-label');
                textName.textContent = i18n[currentLang][key];

                const textVal = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                textVal.setAttribute('x', lx); textVal.setAttribute('y', ly + 4);
                textVal.setAttribute('text-anchor', anchor); textVal.setAttribute('class', 'radar-value');
                textVal.textContent = val;

                labelsGroup.appendChild(textName); labelsGroup.appendChild(textVal);
                
                document.getElementById(`barVal_${key}`).textContent = val;
                setTimeout(() => { document.getElementById(`barFill_${key}`).style.width = `${val}%`; }, 100);
            }

            const playerPolygon = document.getElementById('playerPolygon');
            playerPolygon.setAttribute('points', "50,50 50,50 50,50 50,50 50,50 50,50"); 
            setTimeout(() => { playerPolygon.setAttribute('points', dataPoints.trim()); }, 50);
            document.getElementById('totalScore').innerHTML = `${totalSum} <span style="font-size: 1rem; color: var(--neon-blue);">pts</span>`;
        }

        // --- 5. í€˜ìŠ¤íŠ¸ ë°ì´í„° & ìº˜ë¦°ë” ---
        const weeklyQuestData = [
            [ { stat: "STR", title: {ko:"íœ´ì‹ê³¼ ì‚°ì±…", en:"Rest & Walk", ja:"ä¼‘æ¯ã¨æ•£æ­©"}, desc: {ko:"30ë¶„ ê°€ë²¼ìš´ ê±·ê¸°", en:"30 min light walk", ja:"30åˆ†æ­©è¡Œ"} }, { stat: "STR", title: {ko:"ì½”ì–´ ê°•í™”", en:"Core Strength", ja:"ã‚³ã‚¢å¼·åŒ–"}, desc: {ko:"í”Œë­í¬ 3ì„¸íŠ¸", en:"3 sets of plank", ja:"ãƒ—ãƒ©ãƒ³ã‚¯3ã‚»ãƒƒãƒˆ"} }, { stat: "INT", title: {ko:"ì£¼ê°„ ê³„íš", en:"Weekly Plan", ja:"é€±é–“è¨ˆç”»"}, desc: {ko:"ë‹¤ìŒ ì£¼ ì¼ì • ì •ë¦¬", en:"Organize schedule", ja:"äºˆå®šæ•´ç†"} }, { stat: "INT", title: {ko:"ë…ì„œ íƒ€ì„", en:"Reading", ja:"èª­æ›¸"}, desc: {ko:"ë¹„ë¬¸í•™ 1ì±•í„°", en:"Read 1 chapter", ja:"1ç« èª­ã‚€"} }, { stat: "CHA", title: {ko:"ìê¸° ë°˜ì„±", en:"Reflection", ja:"è‡ªå·±åçœ"}, desc: {ko:"ì¼ê¸° ì‘ì„±í•˜ê¸°", en:"Write journal", ja:"æ—¥è¨˜ä½œæˆ"} }, { stat: "CHA", title: {ko:"ì™¸ì  ì •ëˆ", en:"Grooming", ja:"èº«ã ã—ãªã¿"}, desc: {ko:"ì˜· ë‹¤ë¦¼ì§ˆ", en:"Iron clothes", ja:"æœã®æº–å‚™"} }, { stat: "VIT", title: {ko:"ë°˜ì‹ ìš•", en:"Bath", ja:"åŠèº«æµ´"}, desc: {ko:"ê·¼ìœ¡ í”¼ë¡œ í’€ê¸°", en:"Relieve fatigue", ja:"ç–²åŠ´å›å¾©"} }, { stat: "VIT", title: {ko:"ì˜ì–‘ ê· í˜•", en:"Diet", ja:"æ „é¤Š"}, desc: {ko:"ì±„ì†Œ ìœ„ì£¼ ì‹ë‹¨", en:"Veg-heavy meal", ja:"é‡èœä¸­å¿ƒé£Ÿäº‹"} }, { stat: "WLTH", title: {ko:"ì›”ê°„ ëª©í‘œ", en:"Monthly Goal", ja:"æœˆé–“ç›®æ¨™"}, desc: {ko:"ì €ì¶• ëª©í‘œ ì„¤ì •", en:"Set saving goal", ja:"è²¯è“„ç›®æ¨™"} }, { stat: "WLTH", title: {ko:"ìì‚° ë¦¬ë·°", en:"Net Worth", ja:"è³‡ç”£ç¢ºèª"}, desc: {ko:"ìì‚° í˜„í™© ì ê²€", en:"Check net worth", ja:"è³‡ç”£ç‚¹æ¤œ"} }, { stat: "AGI", title: {ko:"ë””ì§€í„¸ ì •ë¦¬", en:"Declutter", ja:"ãƒ‡ã‚¸ã‚¿ãƒ«æ•´ç†"}, desc: {ko:"ì•ˆ ì“°ëŠ” ì•± ì‚­ì œ", en:"Delete apps", ja:"ã‚¢ãƒ—ãƒªå‰Šé™¤"} }, { stat: "AGI", title: {ko:"ë£¨í‹´ ì„¸íŒ…", en:"Alarms", ja:"ã‚¢ãƒ©ãƒ¼ãƒ "}, desc: {ko:"ì›”ìš”ì¼ ì•ŒëŒ ì„¸íŒ…", en:"Set Monday alarm", ja:"æœˆæ›œã®æº–å‚™"} } ],
            [ { stat: "STR", title: {ko:"1ë§Œë³´ ë‹¬ì„±", en:"10k Steps", ja:"1ä¸‡æ­©"}, desc: {ko:"ê±·ê¸° ëŠ˜ë¦¬ê¸°", en:"Walk more", ja:"æ­©è¡Œè¿½åŠ "} }, { stat: "STR", title: {ko:"í‘¸ì‰¬ì—…", en:"Pushups", ja:"è…•ç«‹ã¦ä¼ã›"}, desc: {ko:"í‘¸ì‰¬ì—… 3ì„¸íŠ¸", en:"3 sets", ja:"3ã‚»ãƒƒãƒˆ"} }, { stat: "INT", title: {ko:"ë…ì„œ ìŠµê´€", en:"Reading", ja:"èª­æ›¸ç¿’æ…£"}, desc: {ko:"10í˜ì´ì§€ ì½ê¸°", en:"Read 10 pages", ja:"10ãƒšãƒ¼ã‚¸"} }, { stat: "INT", title: {ko:"ì§€ì‹ ì²­ì·¨", en:"Podcast", ja:"ãƒãƒƒãƒ‰ã‚­ãƒ£ã‚¹ãƒˆ"}, desc: {ko:"ê²½ì œ íŒŸìºìŠ¤íŠ¸", en:"Eco podcast", ja:"çµŒæ¸ˆè´å–"} }, { stat: "CHA", title: {ko:"ê°ì‚¬ í‘œí˜„", en:"Gratitude", ja:"æ„Ÿè¬"}, desc: {ko:"ë™ë£Œì—ê²Œ ê°ì‚¬", en:"Thank a colleague", ja:"åŒåƒšã«æ„Ÿè¬"} }, { stat: "CHA", title: {ko:"ìŠ¤í‚¨ì¼€ì–´", en:"Skincare", ja:"ã‚¹ã‚­ãƒ³ã‚±ã‚¢"}, desc: {ko:"ë³´ìŠµì œ ë°”ë¥´ê¸°", en:"Apply lotion", ja:"ä¿æ¹¿"} }, { stat: "VIT", title: {ko:"ìˆ˜ë¶„ ì¶©ì „", en:"Hydration", ja:"æ°´åˆ†è£œçµ¦"}, desc: {ko:"ë¬¼ 2ë¦¬í„°", en:"Drink 2L water", ja:"æ°´2L"} }, { stat: "VIT", title: {ko:"ë©˜íƒˆ ì¼€ì–´", en:"Meditation", ja:"ç‘æƒ³"}, desc: {ko:"10ë¶„ ëª…ìƒ", en:"10 mins med", ja:"10åˆ†ç‘æƒ³"} }, { stat: "WLTH", title: {ko:"ë¬´ì§€ì¶œ", en:"No Spend", ja:"ç„¡æ”¯å‡º"}, desc: {ko:"ì†Œë¹„ ì°¸ê¸°", en:"Avoid spending", ja:"æ¶ˆè²»æˆ‘æ…¢"} }, { stat: "WLTH", title: {ko:"ì‹œí™© ì²´í¬", en:"Market", ja:"å¸‚æ³"}, desc: {ko:"ê¸ˆìœµ ê¸°ì‚¬ ìŠ¤í¬ë©", en:"Finance article", ja:"é‡‘èè¨˜äº‹"} }, { stat: "AGI", title: {ko:"ìš°ì„ ìˆœìœ„", en:"Prioritize", ja:"å„ªå…ˆé †ä½"}, desc: {ko:"Top 3 ì—…ë¬´", en:"Top 3 tasks", ja:"ä¸Šä½3æ¥­å‹™"} }, { stat: "AGI", title: {ko:"ë½€ëª¨ë„ë¡œ", en:"Pomodoro", ja:"ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­"}, desc: {ko:"30ë¶„ ì§‘ì¤‘ 1íšŒ", en:"30 min focus", ja:"30åˆ†é›†ä¸­"} } ],
            [ { stat: "STR", title: {ko:"ì¤‘ëŸ‰ íƒ€ê²©", en:"Weights", ja:"ã‚¦ã‚§ã‚¤ãƒˆ"}, desc: {ko:"30ë¶„ ì›¨ì´íŠ¸", en:"30 min lift", ja:"30åˆ†"} }, { stat: "STR", title: {ko:"ë‹¨ë°±ì§ˆ", en:"Protein", ja:"ã‚¿ãƒ³ãƒ‘ã‚¯è³ª"}, desc: {ko:"ë‹¨ë°±ì§ˆ ì‹ì‚¬", en:"Protein meal", ja:"é£Ÿäº‹"} }, { stat: "INT", title: {ko:"ë‹¨ì–´ ìˆ˜ì§‘", en:"Vocab", ja:"å˜èª"}, desc: {ko:"ìƒˆ ë‹¨ì–´ 3ê°œ", en:"3 new words", ja:"æ–°å˜èª3ã¤"} }, { stat: "INT", title: {ko:"ì—…ê³„ ë™í–¥", en:"Trend", ja:"ãƒˆãƒ¬ãƒ³ãƒ‰"}, desc: {ko:"ë¸”ë¡œê·¸ ì½ê¸°", en:"Read blog", ja:"ãƒ–ãƒ­ã‚°"} }, { stat: "CHA", title: {ko:"ì¹­ì°¬í•˜ê¸°", en:"Compliment", ja:"è¤’ã‚ã‚‹"}, desc: {ko:"ì¥ì  ì¹­ì°¬", en:"Praise someone", ja:"é•·æ‰€ã‚’è¤’ã‚ã‚‹"} }, { stat: "CHA", title: {ko:"ì•„ì´ì»¨íƒ", en:"Eye Contact", ja:"ã‚¢ã‚¤ã‚³ãƒ³ã‚¿ã‚¯ãƒˆ"}, desc: {ko:"ëˆˆ ë§ì¶”ê¸°", en:"Make eye contact", ja:"ç›®ã‚’åˆã‚ã›ã‚‹"} }, { stat: "VIT", title: {ko:"ìˆ˜ë©´", en:"Sleep", ja:"ç¡çœ "}, desc: {ko:"7ì‹œê°„ í™•ë³´", en:"Sleep 7+ hrs", ja:"7æ™‚é–“"} }, { stat: "VIT", title: {ko:"ì¹´í˜ì¸ í†µì œ", en:"No Caffeine", ja:"ã‚«ãƒ•ã‚§ã‚¤ãƒ³æ¸›"}, desc: {ko:"ì˜¤í›„ 2ì‹œ ì´í›„ X", en:"None after 2pm", ja:"åˆå¾Œãªã—"} }, { stat: "WLTH", title: {ko:"ê°€ê³„ë¶€", en:"Expense Track", ja:"å®¶è¨ˆç°¿"}, desc: {ko:"ì§€ì¶œ ë‚´ì—­ ì •ë¦¬", en:"Track daily", ja:"æ”¯å‡ºæ•´ç†"} }, { stat: "WLTH", title: {ko:"ì†Œì•¡ ì €ì¶•", en:"Micro Save", ja:"å°‘é¡è²¯é‡‘"}, desc: {ko:"ì—¬ìœ³ëˆ ì €ì¶•", en:"Save small amt", ja:"è²¯è“„"} }, { stat: "AGI", title: {ko:"ì‹¬ë°•ìˆ˜", en:"HR Up", ja:"å¿ƒæ‹æ•°"}, desc: {ko:"15ë¶„ ëŸ¬ë‹", en:"15 min run", ja:"15åˆ†ãƒ©ãƒ³"} }, { stat: "AGI", title: {ko:"ì¸ë°•ìŠ¤ ì œë¡œ", en:"Inbox Zero", ja:"å—ä¿¡ãƒˆãƒ¬ã‚¤"}, desc: {ko:"ë°€ë¦° ë‹µì¥", en:"Clear inbox", ja:"è¿”ä¿¡"} } ],
            [ { stat: "STR", title: {ko:"í•˜ì²´ ê°•í™”", en:"Leg Day", ja:"ä¸‹åŠèº«"}, desc: {ko:"ê³„ë‹¨ ì˜¤ë¥´ê¸°", en:"Stairs", ja:"éšæ®µ"} }, { stat: "STR", title: {ko:"ìŠ¤íŠ¸ë ˆì¹­", en:"Stretch", ja:"ã‚¹ãƒˆãƒ¬ãƒƒãƒ"}, desc: {ko:"ì „ì‹  10ë¶„", en:"10 mins", ja:"10åˆ†"} }, { stat: "INT", title: {ko:"ì¸ì‚¬ì´íŠ¸", en:"Insight", ja:"ã‚¤ãƒ³ã‚µã‚¤ãƒˆ"}, desc: {ko:"TED ê°•ì—°", en:"Watch TED", ja:"TED"} }, { stat: "INT", title: {ko:"ê¸°ë¡", en:"Record", ja:"è¨˜éŒ²"}, desc: {ko:"ë°°ìš´ ì  ìš”ì•½", en:"1 line summary", ja:"1è¡Œè¦ç´„"} }, { stat: "CHA", title: {ko:"ë„¤íŠ¸ì›Œí‚¹", en:"Network", ja:"ãƒãƒƒãƒˆ"}, desc: {ko:"SNS í¬ìŠ¤íŒ…", en:"Post on SNS", ja:"SNSæŠ•ç¨¿"} }, { stat: "CHA", title: {ko:"ë¯¸ì†Œ", en:"Smile", ja:"ç¬‘é¡”"}, desc: {ko:"ë¯¸ì†Œ ì—°ìŠµ", en:"Smile practice", ja:"ç·´ç¿’"} }, { stat: "VIT", title: {ko:"ë‹¹ë¥˜ ì œí•œ", en:"No Sugar", ja:"ç³–è³ªåˆ¶é™"}, desc: {ko:"ë‹¨ê²ƒ í”¼í•˜ê¸°", en:"Avoid sweets", ja:"é¿ã‘ã‚‹"} }, { stat: "VIT", title: {ko:"ì‹í›„ ì‚°ì±…", en:"Walk", ja:"æ•£æ­©"}, desc: {ko:"10ë¶„ ê±·ê¸°", en:"10 min walk", ja:"10åˆ†æ­©è¡Œ"} }, { stat: "WLTH", title: {ko:"ê²½ì œ ì§€ì‹", en:"Study", ja:"å‹‰å¼·"}, desc: {ko:"ìì‚° ê³µë¶€", en:"Learn crypto", ja:"è³‡ç”£å‹‰å¼·"} }, { stat: "WLTH", title: {ko:"í¬íŠ¸í´ë¦¬ì˜¤", en:"Portfolio", ja:"ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª"}, desc: {ko:"ìˆ˜ìµë¥  ì ê²€", en:"Check returns", ja:"åç›Šç‚¹æ¤œ"} }, { stat: "AGI", title: {ko:"íƒ€ì„ ë¸”ë¡œí‚¹", en:"Time Block", ja:"æ™‚é–“ç®¡ç†"}, desc: {ko:"ë‚´ì¼ ì¼ì •", en:"Plan tmrw", ja:"äºˆå®š"} }, { stat: "AGI", title: {ko:"ê³µê°„ ì •ë¦¬", en:"Clean", ja:"ç‰‡ä»˜ã‘"}, desc: {ko:"5ë¶„ ì •ë¦¬", en:"5 min clean", ja:"5åˆ†"} } ],
            [ { stat: "STR", title: {ko:"ë“± ê·¼ìœ¡", en:"Back", ja:"èƒŒç­‹"}, desc: {ko:"í„±ê±¸ì´", en:"Pullups", ja:"æ‡¸å‚"} }, { stat: "STR", title: {ko:"ë°”ë¥¸ ìì„¸", en:"Posture", ja:"å§¿å‹¢"}, desc: {ko:"ê±°ë¶ëª© êµì •", en:"Fix neck", ja:"é¦–çŸ¯æ­£"} }, { stat: "INT", title: {ko:"ë…¼ë¦¬ë ¥", en:"Logic", ja:"è«–ç†"}, desc: {ko:"í¼ì¦ í’€ê¸°", en:"Puzzles", ja:"ãƒ‘ã‚ºãƒ«"} }, { stat: "INT", title: {ko:"ë³µìŠµ", en:"Review", ja:"å¾©ç¿’"}, desc: {ko:"ë©”ëª¨ ì¬í™•ì¸", en:"Review notes", ja:"ãƒ¡ãƒ¢ç¢ºèª"} }, { stat: "CHA", title: {ko:"ê°€ì¡± í†µí™”", en:"Call", ja:"é›»è©±"}, desc: {ko:"ì•ˆë¶€ ë¬»ê¸°", en:"Call family", ja:"é€£çµ¡"} }, { stat: "CHA", title: {ko:"í–¥ê¸°", en:"Scent", ja:"é¦™ã‚Š"}, desc: {ko:"í–¥ìˆ˜ ì‚¬ìš©", en:"Use perfume", ja:"é¦™æ°´"} }, { stat: "VIT", title: {ko:"ë””í†¡ìŠ¤", en:"Detox", ja:"ãƒ‡ãƒˆãƒƒã‚¯ã‚¹"}, desc: {ko:"ìê¸° ì „ í° ë„ê¸°", en:"No phone", ja:"ã‚¹ãƒãƒ›ã‚ªãƒ•"} }, { stat: "VIT", title: {ko:"ì‹¬í˜¸í¡", en:"Breath", ja:"å‘¼å¸"}, desc: {ko:"4-7-8 í˜¸í¡", en:"Deep breath", ja:"æ·±å‘¼å¸"} }, { stat: "WLTH", title: {ko:"êµ¬ë… ì ê²€", en:"Subs", ja:"ã‚µãƒ–ã‚¹ã‚¯"}, desc: {ko:"ì•ˆ ì“°ëŠ” í•´ì§€", en:"Cancel unused", ja:"è§£ç´„"} }, { stat: "WLTH", title: {ko:"ì‚¬ì´ë“œ í—ˆìŠ¬", en:"Hustle", ja:"å‰¯æ¥­"}, desc: {ko:"ìˆ˜ì… êµ¬ìƒ", en:"Income idea", ja:"ã‚¢ã‚¤ãƒ‡ã‚¢"} }, { stat: "AGI", title: {ko:"ë”ë¸” ë½€ëª¨ë„ë¡œ", en:"Focus", ja:"é›†ä¸­"}, desc: {ko:"1ì‹œê°„ ì§‘ì¤‘", en:"1 hr focus", ja:"1æ™‚é–“"} }, { stat: "AGI", title: {ko:"2ë¶„ ë£°", en:"2-Min", ja:"2åˆ†"}, desc: {ko:"ì¦‰ì‹œ í•˜ê¸°", en:"Do it now", ja:"ã™ãã‚„ã‚‹"} } ],
            [ { stat: "STR", title: {ko:"ì „ì‹  ìš´ë™", en:"Full Body", ja:"å…¨èº«"}, desc: {ko:"ìŠ¤ì¿¼íŠ¸+ë²„í”¼", en:"Squat+Burpee", ja:"ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆ"} }, { stat: "STR", title: {ko:"ë¹„íƒ€ë¯¼", en:"Vitamin", ja:"ãƒ“ã‚¿ãƒŸãƒ³"}, desc: {ko:"ì˜ì–‘ì œ ì„­ì·¨", en:"Take pills", ja:"ã‚µãƒ—ãƒª"} }, { stat: "INT", title: {ko:"êµì–‘", en:"Culture", ja:"æ•™é¤Š"}, desc: {ko:"ë‹¤í ì‹œì²­", en:"Watch doc", ja:"ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ã‚¿ãƒªãƒ¼"} }, { stat: "INT", title: {ko:"ë”¥ ì›Œí¬", en:"Deep Work", ja:"æ²¡é ­"}, desc: {ko:"1ì‹œê°„ í•™ìŠµ", en:"1 hr study", ja:"1æ™‚é–“å­¦ç¿’"} }, { stat: "CHA", title: {ko:"ë„ì›€ ì£¼ê¸°", en:"Help", ja:"åŠ©ã‘"}, desc: {ko:"ë™ë£Œ ë•ê¸°", en:"Help someone", ja:"æ‰‹ä¼ã†"} }, { stat: "CHA", title: {ko:"ê²½ì²­", en:"Listen", ja:"å‚¾è´"}, desc: {ko:"ë§ ëŠì§€ ì•Šê¸°", en:"Don't interrupt", ja:"é®ã‚‰ãªã„"} }, { stat: "VIT", title: {ko:"ìŒì£¼ ì¡°ì ˆ", en:"Control", ja:"ç¯€é…’"}, desc: {ko:"ìˆ  ì¤„ì´ê¸°", en:"Drink less", ja:"æ¸›ã‚‰ã™"} }, { stat: "VIT", title: {ko:"ì•ˆêµ¬ íœ´ì‹", en:"Eye Rest", ja:"ç›®ã®ä¼‘æ¯"}, desc: {ko:"ë¨¼ ê³³ ë³´ê¸°", en:"Look away", ja:"é ãã‚’è¦‹ã‚‹"} }, { stat: "WLTH", title: {ko:"ì£¼ê°„ ì˜ˆì‚°", en:"Budget", ja:"äºˆç®—"}, desc: {ko:"ì´ˆê³¼ í™•ì¸", en:"Check budget", ja:"ç¢ºèª"} }, { stat: "WLTH", title: {ko:"ìë™ ì´ì²´", en:"Auto", ja:"è‡ªå‹•æŒ¯æ›¿"}, desc: {ko:"ì ê¸ˆ í™•ì¸", en:"Check auto-save", ja:"ç¢ºèª"} }, { stat: "AGI", title: {ko:"ì£¼ê°„ ë¦¬ë·°", en:"Review", ja:"æŒ¯ã‚Šè¿”ã‚Š"}, desc: {ko:"ë‹¬ì„±ë¥  ì²´í¬", en:"Check goals", ja:"é”æˆç‡"} }, { stat: "AGI", title: {ko:"ì£¼ë§ ê³„íš", en:"Plan", ja:"é€±æœ«è¨ˆç”»"}, desc: {ko:"ì¼ì • ì¡ê¸°", en:"Set plans", ja:"äºˆå®š"} } ],
            [ { stat: "STR", title: {ko:"ì•¼ì™¸ ëŸ¬ë‹", en:"Run", ja:"ãƒ©ãƒ³"}, desc: {ko:"5km ì¡°ê¹…", en:"5km jog", ja:"5km"} }, { stat: "STR", title: {ko:"ìš”ê°€", en:"Yoga", ja:"ãƒ¨ã‚¬"}, desc: {ko:"15ë¶„ ìœ ì—°ì„±", en:"15 min flex", ja:"15åˆ†"} }, { stat: "INT", title: {ko:"ì·¨ë¯¸", en:"Hobby", ja:"è¶£å‘³"}, desc: {ko:"ìœ íŠœë¸Œ 30ë¶„", en:"30 min YT", ja:"30åˆ†"} }, { stat: "INT", title: {ko:"ë‡Œ íœ´ì‹", en:"Brain Rest", ja:"è„³ä¼‘æ¯"}, desc: {ko:"í™œì ì—†ëŠ” ì‹œê°„", en:"No text", ja:"æ´»å­—ãªã—"} }, { stat: "CHA", title: {ko:"ì§€ì¸ ë§Œë‚¨", en:"Meet", ja:"ä¼šã†"}, desc: {ko:"ì¹œêµ¬ ì—°ë½", en:"Contact friend", ja:"é€£çµ¡"} }, { stat: "CHA", title: {ko:"ì·¨í–¥ ê³µìœ ", en:"Share", ja:"å…±æœ‰"}, desc: {ko:"ì¶”ì²œí•˜ê¸°", en:"Recommend", ja:"æ¨è–¦"} }, { stat: "VIT", title: {ko:"ë‚®ì ", en:"Nap", ja:"æ˜¼å¯"}, desc: {ko:"íŒŒì›Œ ë‚®ì ", en:"Power nap", ja:"ä»®çœ "} }, { stat: "VIT", title: {ko:"í–‡ë¹› ì¬ê¸°", en:"Sun", ja:"æ—¥å…‰æµ´"}, desc: {ko:"15ë¶„ ì•¼ì™¸", en:"15 mins out", ja:"15åˆ†"} }, { stat: "WLTH", title: {ko:"ë¶€ë™ì‚°/ì„ì¥", en:"Real Estate", ja:"ä¸å‹•ç”£"}, desc: {ko:"ì‹œì„¸ ë³´ê¸°", en:"Check prices", ja:"ç›¸å ´"} }, { stat: "WLTH", title: {ko:"ì£¼ë§ ì˜ˆì‚°", en:"Budget", ja:"äºˆç®—"}, desc: {ko:"í•œë„ ì„¤ì •", en:"Set limit", ja:"é™åº¦"} }, { stat: "AGI", title: {ko:"ë°€í”„ë ™", en:"Meal Prep", ja:"ä½œã‚Šç½®ã"}, desc: {ko:"ì¬ë£Œ ì†ì§ˆ", en:"Prep food", ja:"æº–å‚™"} }, { stat: "AGI", title: {ko:"ì§‘ì•ˆì¼", en:"Chores", ja:"å®¶äº‹"}, desc: {ko:"ëŒ€ì²­ì†Œ", en:"Cleaning", ja:"æƒé™¤"} } ]
        ];

        let currentDayOfWeek = new Date().getDay(); 
        let questCompletedState = Array.from({length: 7}, () => Array(12).fill(false));

        function renderQuestList() {
            const container = document.getElementById('quest-list-container');
            container.innerHTML = '';
            
            weeklyQuestData[currentDayOfWeek].forEach((q, idx) => {
                const isDone = questCompletedState[currentDayOfWeek][idx];
                const row = document.createElement('div');
                row.className = `quest-row ${isDone ? 'done' : ''}`;
                row.onclick = () => toggleQuest(idx);

                row.innerHTML = `
                    <div>
                        <div class="quest-title"><span class="quest-stat-tag">${q.stat}</span>${q.title[currentLang]}</div>
                        <div class="quest-desc">${q.desc[currentLang]}</div>
                    </div>
                    <div class="quest-checkbox"></div>
                `;
                container.appendChild(row);
            });
        }

        function toggleQuest(idx) {
            const state = questCompletedState[currentDayOfWeek];
            state[idx] = !state[idx];
            if(state[idx]) userPoints += 20; else userPoints -= 20;
            renderQuestList(); renderCalendar(); updatePointUI(); 
        }

        function renderCalendar() {
            const calGrid = document.getElementById('calendar-grid'); calGrid.innerHTML = '';
            const today = new Date(); const startOfWeek = new Date(today);
            startOfWeek.setDate(today.getDate() - currentDayOfWeek);

            const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            document.getElementById('cal-month').innerText = `${monthNames[startOfWeek.getMonth()]} ${startOfWeek.getFullYear()}`;

            const dayNames = { ko: ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "], en: ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"], ja: ["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"] };

            for (let i = 0; i < 7; i++) {
                const cDate = new Date(startOfWeek); cDate.setDate(startOfWeek.getDate() + i);
                const count = questCompletedState[i].filter(v => v).length;
                const dayDiv = document.createElement('div');
                dayDiv.className = `cal-day ${i === currentDayOfWeek ? 'today' : ''}`;
                dayDiv.innerHTML = `<div class="cal-name">${dayNames[currentLang][i]}</div><div class="cal-date">${cDate.getDate()}</div><div class="cal-score">${count}/12</div>`;
                calGrid.appendChild(dayDiv);
            }
        }

        // --- 6. ì†Œì…œ ë­í‚¹ ---
        let currentSocialMode = 'global'; 
        let currentSortCriteria = 'total';
        const userData = [
            { id: 1, name: "Gwangju_Runner", title: {ko:"ë¬´ë“±ì‚° í˜¸ë‘ì´", en:"Tiger of Mudeung", ja:"ç„¡ç­‰å±±ã®è™"}, str: 95, int: 50, cha: 70, vit: 90, wlth: 30, agi: 85, isMe: false, isFriend: false },
            { id: 2, name: "Camus_Reader", title: {ko:"ì‹¤ì¡´ì£¼ì˜ì", en:"Existentialist", ja:"å®Ÿå­˜ä¸»ç¾©è€…"}, str: 30, int: 98, cha: 50, vit: 40, wlth: 60, agi: 40, isMe: false, isFriend: true },
            { id: 3, name: {ko:"í”Œë ˆì´ì–´ (ë‚˜)", en:"Player (Me)", ja:"ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ (ç§)"}, title: titleHistory[0].title, str: myStats.str, int: myStats.int, cha: myStats.cha, vit: myStats.vit, wlth: myStats.wlth, agi: myStats.agi, isMe: true, isFriend: false },
            { id: 4, name: "GangnamBabel", title: {ko:"êµ­ê°€ê¶Œë ¥ê¸‰ ìë³¸", en:"S-Class Wealth", ja:"å›½å®¶æ¨©åŠ›ç´š è³‡æœ¬"}, str: 60, int: 80, cha: 90, vit: 50, wlth: 99, agi: 50, isMe: false, isFriend: false }
        ];
        userData.forEach(u => u.total = u.str + u.int + u.cha + u.vit + u.wlth + u.agi);

        function toggleSocialMode(mode, btn) {
            currentSocialMode = mode;
            document.querySelectorAll('.social-tab-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active');
            document.getElementById('ranking-controls').style.display = mode === 'global' ? 'flex' : 'none';
            renderUsers(currentSortCriteria);
        }

        function renderUsers(criteria, btn = null) {
            if(btn) {
                currentSortCriteria = criteria;
                document.querySelectorAll('.rank-tab-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active');
            }
            const container = document.getElementById('user-list-container'); container.innerHTML = '';
            let dUsers = [...userData];
            if(currentSocialMode === 'friends') dUsers = dUsers.filter(u => u.isFriend);
            dUsers.sort((a, b) => b[criteria] - a[criteria]);

            if(dUsers.length === 0) { container.innerHTML = `<div style="text-align:center; padding:20px; color:var(--text-sub);">${i18n[currentLang].no_friend}</div>`; return; }

            dUsers.forEach((user, i) => {
                const card = document.createElement('div'); card.className = `user-card ${user.isMe ? 'my-rank' : ''}`;
                const rDisp = currentSocialMode === 'global' ? `<div style="font-size:1.1rem; font-weight:bold; color:var(--text-sub); width:25px; text-align:center;">${i+1}</div>` : '';
                let fBtn = '';
                if(!user.isMe) fBtn = user.isFriend ? `<button class="btn-friend added" onclick="toggleFriend(${user.id})">${i18n[currentLang].btn_added}</button>` : `<button class="btn-friend" onclick="toggleFriend(${user.id})">${i18n[currentLang].btn_add}</button>`;
                
                const tDisp = user.isMe ? titleHistory[titleHistory.length-1].title[currentLang] : (typeof user.title === 'object' ? user.title[currentLang] : user.title);
                const nDisp = typeof user.name === 'object' ? user.name[currentLang] : user.name;

                card.innerHTML = `${rDisp}<div class="user-info"><div class="title-badge">${tDisp}</div><div style="font-size: 0.95rem;">${nDisp}</div></div><div class="user-score">${user[criteria]}</div>${fBtn}`;
                container.appendChild(card);
            });
        }
        function toggleFriend(id) { const u = userData.find(x => x.id === id); if(u) { u.isFriend = !u.isFriend; renderUsers(currentSortCriteria); } }

        // --- 7. GPS ë¡œì§ ---
        let watchId = null;
        function toggleGPS() {
            const isChecked = document.getElementById('gps-toggle').checked;
            const statusDiv = document.getElementById('gps-status');
            statusDiv.style.display = 'flex';
            if(isChecked) {
                statusDiv.innerHTML = '...';
                if ("geolocation" in navigator) {
                    watchId = navigator.geolocation.watchPosition(
                        (p) => { statusDiv.innerHTML = `<span style="color:var(--neon-blue);">${i18n[currentLang].gps_on}</span>`; },
                        (e) => { statusDiv.innerHTML = `<span style="color:var(--neon-red);">${i18n[currentLang].gps_err}</span>`; document.getElementById('gps-toggle').checked = false; },
                        { enableHighAccuracy: true }
                    );
                }
            } else {
                if(watchId !== null) navigator.geolocation.clearWatch(watchId);
                statusDiv.innerHTML = `<span style="color:var(--text-sub);">${i18n[currentLang].gps_off}</span>`;
            }
        }

        // --- 8. ì‹ ê·œ: ê±´ê°• ì•± ë™ê¸°í™” ì‹œë®¬ë ˆì´ì…˜ ---
        function toggleHealthSync() {
            const isChecked = document.getElementById('sync-toggle').checked;
            const statusDiv = document.getElementById('sync-status');
            statusDiv.style.display = 'flex';

            if(isChecked) {
                // 1. ìš”ì²­ ì¤‘ í‘œì‹œ
                statusDiv.innerHTML = `<span style="color:var(--text-sub);">${i18n[currentLang].sync_req}</span>`;
                
                // 2. 2ì´ˆ í›„ API ì‘ë‹µ ìˆ˜ì‹  ì‹œë®¬ë ˆì´ì…˜
                setTimeout(() => {
                    statusDiv.innerHTML = `<span style="color:var(--neon-blue);">${i18n[currentLang].sync_done}</span>`;
                    
                    // ë°ì´í„° ì—°ë™ìœ¼ë¡œ ì¸í•œ ìŠ¤íƒ¯ ë° í¬ì¸íŠ¸ ìƒìŠ¹
                    myStats.str = Math.min(100, myStats.str + 3);
                    myStats.vit = Math.min(100, myStats.vit + 2);
                    userPoints += 50; // ê±¸ìŒìˆ˜ ë³´ìƒ í¬ì¸íŠ¸
                    
                    updatePointUI();
                    drawRadarChart();
                }, 2000);
            } else {
                // í•´ì œ
                statusDiv.innerHTML = `<span style="color:var(--text-sub);">${i18n[currentLang].sync_off}</span>`;
            }
        }

        // ì´ˆê¸° êµ¬ë™
        window.onload = () => {
            changeTheme(); 
            changeLanguage('ko'); 
            renderCalendar();
            updatePointUI();
        };
    </script>
</body>
</html>
