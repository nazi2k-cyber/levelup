<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>LEVEL UP: REBOOT | Optimized MVP</title>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        
        :root {
            --bg-dark: #050508; --panel-bg: rgba(15, 25, 40, 0.95);
            --text-main: #ffffff; --text-sub: #aaaaaa; --border-color: #333333;
            --neon-blue: #00d9ff; --neon-gold: #ffcc00; --neon-purple: #b53cff;
            --neon-red: #ff3c3c; --nav-bg: #0a0a10;
        }

        [data-theme="light"] {
            --bg-dark: #f4f5f7; --panel-bg: #ffffff;
            --text-main: #1a1a1a; --text-sub: #666666; --border-color: #dddddd;
            --neon-blue: #0066cc; --neon-gold: #d4a017; --neon-purple: #8a2be2;
            --neon-red: #dc3545; --nav-bg: #ffffff;
        }

        body {
            background-color: var(--bg-dark); color: var(--text-main);
            font-family: 'Pretendard', -apple-system, sans-serif;
            margin: 0; padding-top: env(safe-area-inset-top); padding-bottom: env(safe-area-inset-bottom); 
            display: flex; flex-direction: column; height: 100vh; height: 100dvh;
            box-sizing: border-box; overflow: hidden; transition: background-color 0.3s, color 0.3s;
        }

        /* --- 1. ë¡œê·¸ì¸ ìŠ¤í¬ë¦° --- */
        #login-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--bg-dark); z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            padding: 20px; box-sizing: border-box; transition: background-color 0.3s;
        }
        .login-box {
            width: 100%; max-width: 350px; background: var(--panel-bg);
            border: 1px solid var(--border-color); border-radius: 12px;
            padding: 30px 20px; box-shadow: 0 0 25px rgba(0, 217, 255, 0.15); text-align: center;
        }
        .login-title { font-size: 1.8rem; font-weight: 900; color: var(--neon-blue); margin-bottom: 5px; letter-spacing: 1px; }
        .login-sub { font-size: 0.85rem; color: var(--text-sub); margin-bottom: 25px; }
        .login-input {
            width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 6px;
            border: 1px solid var(--border-color); background: rgba(0,0,0,0.3);
            color: var(--text-main); box-sizing: border-box; outline: none; font-size: 0.9rem;
        }
        .login-input:focus { border-color: var(--neon-blue); box-shadow: 0 0 8px rgba(0, 217, 255, 0.3); }
        [data-theme="light"] .login-input { background: rgba(255,255,255,0.8); }
        .hint-text { font-size: 0.7rem; color: var(--text-sub); text-align: left; margin-top: -6px; margin-bottom: 10px; padding-left: 5px; display: none; }
        .disclaimer-text { font-size: 0.65rem; color: #888; text-align: left; margin-bottom: 15px; padding: 0 5px; line-height: 1.3; display: none; }
        .btn-google { background: #fff; color: #333; border: 1px solid #ddd; display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 10px; }
        .login-toggle { font-size: 0.8rem; color: var(--text-sub); margin-top: 20px; cursor: pointer; text-decoration: underline; }

        /* --- ë©”ì¸ ì•± ë ˆì´ì•„ì›ƒ --- */
        #app-container { display: none; flex-direction: column; width: 100%; height: 100%; }
        header { padding: 12px 20px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; background: var(--panel-bg); z-index: 10; }
        #sys-title { font-weight: 900; letter-spacing: 1px; font-size: 1.1rem; }
        .level-badge { background: var(--neon-blue); color: #fff; font-weight: bold; padding: 4px 10px; border-radius: 4px; font-size: 0.8rem; }
        main { flex-grow: 1; overflow-y: auto; padding: 15px; padding-bottom: calc(80px + env(safe-area-inset-bottom)); }
        .view-section { display: none; animation: fadeIn 0.3s ease; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(3px); } to { opacity: 1; transform: translateY(0); } }

        /* --- UI ì»´í¬ë„ŒíŠ¸ ìµœì í™” --- */
        .system-card { background: var(--panel-bg); border: 1px solid var(--border-color); padding: 15px; border-radius: 10px; margin-bottom: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        h2 { font-size: 1rem; color: var(--neon-blue); margin-top: 0; margin-bottom: 12px; text-transform: uppercase; }

        /* í”„ë¡œí•„ ë° ë ˆë²¨ì—… í†µí•© ì••ì¶• ë ˆì´ì•„ì›ƒ */
        .profile-compact-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .profile-box { display: flex; align-items: center; gap: 12px; }
        .profile-image-container { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--neon-blue); background: #222; overflow: hidden; display: flex; justify-content: center; align-items: center; }
        .profile-img { width: 60%; height: 60%; object-fit: contain; filter: invert(0.5); }
        .title-badge { display: inline-block; padding: 2px 6px; font-size: 0.65rem; font-weight: bold; background: linear-gradient(45deg, rgba(181, 60, 255, 0.2), transparent); border: 1px solid var(--neon-purple); color: var(--neon-purple); border-radius: 4px; margin-bottom: 3px; }
        .name-container { display: flex; align-items: center; gap: 5px; }
        .btn-edit-name { background: none; border: none; font-size: 0.8rem; cursor: pointer; padding: 0; color: var(--text-sub); }
        
        .compact-score-box { text-align: right; }
        .compact-score-val { font-size: 1.6rem; font-weight: 900; color: var(--neon-blue); line-height: 1; }

        .levelup-panel-compact { display: flex; justify-content: space-between; align-items: center; background: rgba(255, 204, 0, 0.05); border: 1px solid var(--neon-gold); padding: 10px 12px; border-radius: 6px; }
        .btn-primary { padding: 10px; background: var(--neon-blue); border: none; color: white; font-weight: bold; border-radius: 6px; cursor: pointer; text-align: center; font-size: 0.85rem; width: 100%; }
        .btn-levelup-sm { width: auto; padding: 6px 12px; font-size: 0.8rem; }
        .btn-primary:disabled { background: #444; color: #777; border-color: #333; cursor: not-allowed; }

        /* ë ˆì´ë” ì°¨íŠ¸ ë° ìŠ¤íƒ¯ë°” ì••ì¶• */
        .radar-chart-container { display: flex; justify-content: center; margin: 5px 0 15px 0; }
        .radar-chart { width: 100%; max-width: 150px; height: auto; aspect-ratio: 1/1; }
        .radar-bg-line { fill: none; stroke: var(--border-color); stroke-width: 0.8; }
        .radar-polygon { fill: rgba(0, 217, 255, 0.25); stroke: var(--neon-blue); stroke-width: 2; transition: all 0.6s ease; }
        .radar-point { fill: var(--neon-blue); transition: all 0.6s; }
        .radar-label { fill: var(--text-sub); font-size: 8px; font-weight: bold; }
        .radar-value { fill: var(--neon-blue); font-size: 8px; font-weight: bold; }
        
        .stat-info { display: flex; justify-content: space-between; margin-bottom: 2px; font-size: 0.75rem; font-weight: 500;}
        .progress-bg { height: 4px; background: #2a2a2a; border-radius: 4px; overflow: hidden; margin-bottom: 8px; }
        .progress-fill { height: 100%; background: var(--neon-blue); box-shadow: 0 0 5px var(--neon-blue); transition: width 1s; width: 0%; }
        [data-theme="light"] .progress-bg { background: #e0e0e0; }
        .pending-stat { color: var(--neon-gold); font-size: 0.7rem; margin-left: 5px; font-weight: bold; }

        /* í€˜ìŠ¤íŠ¸ & ìº˜ë¦°ë” */
        .quest-list-wrapper { max-height: 350px; overflow-y: auto; padding-right: 5px; scrollbar-width: none; }
        .quest-list-wrapper::-webkit-scrollbar { display: none; }
        .quest-row { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid var(--border-color); cursor: pointer; border-radius: 6px; }
        .quest-row:last-child { border-bottom: none; }
        .quest-stat-tag { font-size: 0.6rem; font-weight: bold; padding: 2px 4px; border-radius: 3px; margin-right: 6px; border: 1px solid var(--neon-blue); color: var(--neon-blue); }
        .quest-title { font-size: 0.85rem; font-weight: bold; margin-bottom: 2px; display: flex; align-items: center; }
        .quest-desc { font-size: 0.7rem; color: var(--text-sub); margin-left: 32px; }
        .quest-checkbox { width: 18px; height: 18px; border: 2px solid var(--neon-blue); border-radius: 50%; display: flex; justify-content: center; align-items: center; transition: 0.2s; }
        .quest-row.done { opacity: 0.5; }
        .quest-row.done .quest-title { text-decoration: line-through; }
        .quest-row.done .quest-checkbox { background: var(--neon-gold); border-color: var(--neon-gold); }
        .quest-row.done .quest-checkbox::after { content: "âœ“"; color: #000; font-size: 12px; font-weight: bold; }

        .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 0.85rem; font-weight: bold; color: var(--neon-blue); }
        .cal-grid { display: flex; justify-content: space-between; gap: 4px; }
        .cal-day { flex: 1; text-align: center; padding: 8px 0; background: rgba(255,255,255,0.02); border-radius: 6px; border: 1px solid var(--border-color); }
        .cal-day.today { background: rgba(0, 217, 255, 0.1); border-color: var(--neon-blue); }
        .cal-name { font-size: 0.6rem; color: var(--text-sub); margin-bottom: 2px; }
        .cal-date { font-size: 1rem; font-weight: bold; color: var(--text-main); }
        .cal-score { font-size: 0.65rem; color: var(--neon-gold); margin-top: 3px; }

        /* ë˜ì „, ì†Œì…œ, ì„¤ì • */
        .dungeon-banner { border: 1px solid var(--neon-red); background: rgba(255, 60, 60, 0.05); text-align: center; }
        .map-container { width: 100%; height: 180px; border-radius: 6px; overflow: hidden; margin-bottom: 12px; border: 1px solid var(--border-color); }
        .map-container iframe { width: 100%; height: 100%; border: none; }
        
        .social-header { display: flex; gap: 8px; margin-bottom: 12px; }
        .social-tab-btn { flex: 1; padding: 8px; background: transparent; border: 1px solid var(--border-color); color: var(--text-sub); border-radius: 6px; cursor: pointer; font-size: 0.85rem; font-weight: bold; }
        .social-tab-btn.active { background: rgba(0, 217, 255, 0.1); border-color: var(--neon-blue); color: var(--neon-blue); }
        .rank-tabs { display: flex; gap: 6px; margin-bottom: 12px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
        .rank-tabs::-webkit-scrollbar { display: none; }
        .rank-tab-btn { white-space: nowrap; padding: 5px 10px; font-size: 0.7rem; background: transparent; border: 1px solid var(--border-color); color: var(--text-sub); border-radius: 20px; }
        .rank-tab-btn.active { background: var(--neon-blue); color: #fff; border-color: var(--neon-blue); font-weight: bold;}
        .user-card { display: flex; align-items: center; justify-content: space-between; padding: 10px; background: rgba(255,255,255,0.02); border: 1px solid var(--border-color); border-radius: 6px; margin-bottom: 8px; }
        .user-card.my-rank { border-color: var(--neon-gold); background: rgba(255, 204, 0, 0.05); }
        .user-info { flex-grow: 1; margin-left: 10px; }
        .user-score { font-weight: 900; color: var(--neon-blue); font-size: 1rem; text-align: right; margin-right: 12px; }
        .btn-friend { padding: 4px 8px; font-size: 0.65rem; font-weight: bold; background: transparent; border: 1px solid var(--neon-blue); color: var(--neon-blue); border-radius: 4px; }
        .btn-friend.added { background: var(--neon-blue); color: #fff; }

        .setting-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border-color); font-size: 0.85rem; }
        .setting-row:last-child { border-bottom: none; }
        .custom-select { background: transparent; color: var(--text-main); border: 1px solid var(--neon-blue); padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; outline: none; }
        .custom-select option { background: var(--bg-dark); color: var(--text-main); }
        [data-theme="light"] .custom-select { border-color: var(--border-color); color: var(--text-main); }
        [data-theme="light"] .custom-select option { background: #ffffff; color: #1a1a1a; }
        
        .switch { position: relative; width: 40px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #ccc; border-radius: 22px; transition: .3s; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background: white; border-radius: 50%; transition: .3s; }
        input:checked + .slider { background: var(--neon-blue); }
        input:checked + .slider:before { transform: translateX(18px); }

        /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */
        nav { position: fixed; bottom: env(safe-area-inset-bottom); width: 100%; height: 65px; background: var(--nav-bg); display: flex; border-top: 1px solid var(--border-color); z-index: 10; }
        .nav-item { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 0.6rem; color: var(--text-sub); cursor: pointer; }
        .nav-item.active { color: var(--neon-blue); }
        .nav-icon { font-size: 1.2rem; margin-bottom: 3px; }

        /* ëª¨ë‹¬ */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 100; display: none; justify-content: center; align-items: center; backdrop-filter: blur(3px); }
        .modal-content { background: var(--panel-bg); border: 1px solid var(--neon-blue); padding: 20px; border-radius: 10px; width: 85%; max-height: 70vh; display: flex; flex-direction: column; }
        .modal-header { font-size: 1.1rem; font-weight: bold; color: var(--neon-blue); margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
        .modal-close { background: none; border: none; color: var(--text-sub); font-size: 1.5rem; cursor: pointer; }
        .history-list { overflow-y: auto; flex-grow: 1; }
        .history-item { padding: 10px 0; border-bottom: 1px dashed var(--border-color); display: flex; justify-content: space-between; align-items: center; }
        .history-item:last-child { border-bottom: none; }
        .hist-lvl { color: var(--neon-gold); font-weight: bold; font-size: 0.75rem; }
        .hist-title { color: var(--text-main); font-size: 0.9rem; font-weight: bold; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <div class="login-title">LEVEL UP: REBOOT</div>
            <div class="login-sub" id="login-desc" data-i18n="login_desc">ì‹œìŠ¤í…œì— ì ‘ì†í•˜ì—¬ í˜„ì‹¤ì„ ê²Œì„ì²˜ëŸ¼.</div>
            
            <input type="email" class="login-input" id="login-email" data-i18n-placeholder="ph_email">
            <input type="password" class="login-input" id="login-pw" data-i18n-placeholder="ph_pw">
            <div id="pw-hint" class="hint-text" data-i18n="pw_req_hint">â€» 8ìë¦¬ ì´ìƒ, ëŒ€ë¬¸ì 1ê°œ ì´ìƒ, íŠ¹ìˆ˜ë¬¸ì 2ê°œ ì´ìƒ í¬í•¨</div>
            <input type="password" class="login-input" id="login-pw-confirm" style="display: none;" data-i18n-placeholder="ph_pw_conf">
            
            <div id="disclaimer-box" class="disclaimer-text" style="display: none;" data-i18n="disclaimer_txt">
                â€» ê°€ì… ì‹œ ì´ìš©ì•½ê´€ ë° ë©´ì±…ì‚¬í•­ì— ë™ì˜í•˜ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤. ë³¸ ì•±ì€ ì˜ë£Œ ë³´ì¡° ê¸°êµ¬ê°€ ì•„ë‹ˆë©°, í€˜ìŠ¤íŠ¸ ìˆ˜í–‰ ì¤‘ ë°œìƒí•˜ëŠ” ì‹ ì²´ì  ë¶€ìƒì´ë‚˜ ì†í•´ì— ëŒ€í•´ ì¼ì ˆ ì±…ì„ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.
            </div>

            <button class="btn-primary" style="margin-bottom: 10px;" onclick="simulateLogin()" id="btn-login-submit" data-i18n="btn_login_submit">ì‹œìŠ¤í…œ ì ‘ì†</button>
            <button class="btn-primary btn-google" onclick="simulateGoogleLogin()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.16v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.16C1.43 8.55 1 10.22 1 12s.43 3.45 1.16 4.93l3.68-2.84z" fill="#FBBC05"/>
                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.16 7.07l3.68 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
                </svg>
                <span data-i18n="btn_google_login">Google ê³„ì •ìœ¼ë¡œ ê³„ì†</span>
            </button>
            <div class="login-toggle" onclick="toggleAuthMode()" id="auth-toggle-text" data-i18n="auth_toggle_signup">ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? íšŒì›ê°€ì…</div>
        </div>
    </div>

    <div id="app-container">
        <header>
            <div id="sys-title">LEVEL UP: REBOOT</div>
            <div class="level-badge" id="sys-level">Lv. 1</div>
        </header>

        <main>
            <section id="status" class="view-section active">
                <div class="system-card">
                    <div class="profile-compact-header">
                        <div class="profile-box">
                            <div class="profile-image-container">
                                <img class="profile-img" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23555'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E" alt="Profile">
                            </div>
                            <div>
                                <div class="title-badge" id="prof-title-badge" onclick="openTitleModal()" style="cursor:pointer;">ì‹ ê·œ ê°ì„±ì â„¹ï¸</div>
                                <div class="name-container">
                                    <div style="font-size: 1rem; font-weight: bold;" id="prof-name" data-i18n="prof_name">í”Œë ˆì´ì–´ (ë‚˜)</div>
                                    <button class="btn-edit-name" onclick="changePlayerName()">âœï¸</button>
                                </div>
                            </div>
                        </div>
                        <div class="compact-score-box">
                            <div style="font-size: 0.65rem; color: var(--text-sub);" data-i18n="tot_score">ì¢…í•© ìŠ¤ì½”ì–´</div>
                            <div class="compact-score-val" id="totalScore">0</div>
                        </div>
                    </div>

                    <div class="levelup-panel-compact">
                        <div>
                            <div style="font-size: 0.65rem; color: var(--text-sub);" data-i18n="avail_pts">ë³´ìœ  í¬ì¸íŠ¸</div>
                            <div style="font-size: 1.3rem; font-weight: 900; color: var(--neon-gold);"><span id="display-pts">0</span><span style="font-size: 0.8rem;"> P</span></div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="font-size: 0.6rem; color: var(--text-sub); text-align: right;">
                                <span data-i18n="req_pts">ìš”êµ¬ëŸ‰:</span><br><span id="display-req-pts">100</span> P
                            </div>
                            <button id="btn-levelup" class="btn-primary btn-levelup-sm" onclick="processLevelUp()" data-i18n="btn_lvlup">ë ˆë²¨ ì—…</button>
                        </div>
                    </div>
                </div>

                <div class="system-card">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 5px;">
                        <h2 data-i18n="radar_title" style="margin:0;">Stat Radar</h2>
                        <span style="font-size: 0.65rem; color:var(--neon-gold);" data-i18n="stat_hint">â€» ëŒ€ê¸° ìŠ¤íƒ¯ì€ ë ˆë²¨ì—… ì‹œ ë°˜ì˜ë¨</span>
                    </div>
                    
                    <div class="radar-chart-container">
                        <svg class="radar-chart" viewBox="0 0 100 100" id="radarSvg">
                            <g id="radarGrid"></g><g id="radarAxes"></g>
                            <polygon id="playerPolygon" class="radar-polygon" points="" />
                            <g id="radarPoints"></g><g id="radarLabels"></g>
                        </svg>
                    </div>
                    
                    <div>
                        <div class="stat-info"><span data-i18n="bar_str">ê·¼ë ¥ (ë¬¼ë¦¬/ìš´ë™)</span><div><span style="color:var(--neon-blue)" id="barVal_str">0</span><span class="pending-stat" id="pendVal_str"></span></div></div>
                        <div class="progress-bg"><div class="progress-fill" id="barFill_str"></div></div>
                        
                        <div class="stat-info"><span data-i18n="bar_int">ì§€ëŠ¥ (í•™ìŠµ/ì¸ì§€)</span><div><span style="color:var(--neon-blue)" id="barVal_int">0</span><span class="pending-stat" id="pendVal_int"></span></div></div>
                        <div class="progress-bg"><div class="progress-fill" id="barFill_int"></div></div>
                        
                        <div class="stat-info"><span data-i18n="bar_cha">ë§¤ë ¥ (ì¸ë§¥/ì†Œí†µ)</span><div><span style="color:var(--neon-blue)" id="barVal_cha">0</span><span class="pending-stat" id="pendVal_cha"></span></div></div>
                        <div class="progress-bg"><div class="progress-fill" id="barFill_cha"></div></div>
                        
                        <div class="stat-info"><span data-i18n="bar_vit">ì²´ë ¥ (ìˆ˜ë©´/íšŒë³µ)</span><div><span style="color:var(--neon-blue)" id="barVal_vit">0</span><span class="pending-stat" id="pendVal_vit"></span></div></div>
                        <div class="progress-bg"><div class="progress-fill" id="barFill_vit"></div></div>
                        
                        <div class="stat-info"><span data-i18n="bar_wlth">ì¬ë ¥ (ìë³¸/íˆ¬ì)</span><div><span style="color:var(--neon-blue)" id="barVal_wlth">0</span><span class="pending-stat" id="pendVal_wlth"></span></div></div>
                        <div class="progress-bg"><div class="progress-fill" id="barFill_wlth"></div></div>
                        
                        <div class="stat-info"><span data-i18n="bar_agi">ë¯¼ì²© (ì‹œê°„/íš¨ìœ¨)</span><div><span style="color:var(--neon-blue)" id="barVal_agi">0</span><span class="pending-stat" id="pendVal_agi"></span></div></div>
                        <div class="progress-bg"><div class="progress-fill" id="barFill_agi"></div></div>
                    </div>
                </div>
            </section>

            <section id="quests" class="view-section">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                    <h2 data-i18n="quest_title" style="margin:0;">Daily Quests</h2>
                    <span style="font-size:0.7rem; color:var(--neon-gold);" data-i18n="quest_hint">â€» ì™„ë£Œ ì‹œ +20P & ìŠ¤íƒ¯ +0.5</span>
                </div>
                <div class="system-card" style="padding:10px;">
                    <div class="quest-list-wrapper" id="quest-list-container"></div>
                </div>
                <div class="system-card calendar-wrapper">
                    <div class="cal-header">
                        <span data-i18n="cal_title">ì£¼ê°„ ì§„ì²™ë„</span>
                        <span style="font-size:0.75rem; color:var(--text-sub);" id="cal-month"></span>
                    </div>
                    <div class="cal-grid" id="calendar-grid"></div>
                </div>
            </section>

            <section id="dungeon" class="view-section">
                <h2 data-i18n="raid_title">Local Raid</h2>
                <div class="system-card dungeon-banner">
                    <h3 style="color: var(--neon-red); margin: 0 0 10px 0; font-size:1.1rem;" data-i18n="raid_boss">âš ï¸ ì„œìš¸ ê°•ë‚¨ ì—°í•© ë³´ìŠ¤ ì¶œí˜„</h3>
                    <div class="map-container">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3164.8872958213665!2d127.02498261564757!3d37.49805097981048!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x357ca1598c471015%3A0x6b0d1e57c631a3!2z6rCV64Ko7Jet!5e0!3m2!1sko!2skr!4v1690000000000!5m2!1sko!2skr" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                    <p style="font-size: 0.8rem; color: var(--text-main); margin-bottom: 5px;" data-i18n="raid_desc1">"í‡´ê·¼ê¸¸ì˜ ìœ í˜¹ì"ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                    <p style="font-size: 0.7rem; color: var(--text-sub);" data-i18n="raid_desc2">ê·¼ì²˜ í—Œí„°ë“¤ê³¼ ì—°í•©í•˜ì—¬ 2ì‹œê°„ ë‚´<br>í•©ì‚° 50kmë¥¼ ë‹¬ì„±í•˜ê³  ì „ë¦¬í’ˆì„ íšë“í•˜ì„¸ìš”.</p>
                    <div style="font-size: 0.8rem; margin: 12px 0; font-weight:bold;"><span data-i18n="raid_part">ì°¸ì—¬ ì¸ì›: </span><span style="color:var(--neon-blue)">4</span> / 10</div>
                    <button class="btn-primary" style="background: var(--neon-red);" data-i18n="raid_btn">ë ˆì´ë“œ ì…ì¥í•˜ê¸°</button>
                </div>
            </section>

            <section id="social" class="view-section">
                <div class="social-header">
                    <button class="social-tab-btn active" onclick="toggleSocialMode('global', this)" data-i18n="soc_global">ğŸ† ê¸€ë¡œë²Œ ë­í‚¹</button>
                    <button class="social-tab-btn" onclick="toggleSocialMode('friends', this)" data-i18n="soc_friend">ğŸ‘¥ ë‚´ ì¹œêµ¬</button>
                </div>
                <div id="ranking-controls" class="rank-tabs">
                    <button class="rank-tab-btn active" onclick="renderUsers('total', this)" data-i18n="sort_tot">ì¢…í•©ìŠ¤ì½”ì–´</button>
                    <button class="rank-tab-btn" onclick="renderUsers('str', this)" data-i18n="sort_str">ê·¼ë ¥</button>
                    <button class="rank-tab-btn" onclick="renderUsers('int', this)" data-i18n="sort_int">ì§€ëŠ¥</button>
                    <button class="rank-tab-btn" onclick="renderUsers('cha', this)" data-i18n="sort_cha">ë§¤ë ¥</button>
                    <button class="rank-tab-btn" onclick="renderUsers('vit', this)" data-i18n="sort_vit">ì²´ë ¥</button>
                    <button class="rank-tab-btn" onclick="renderUsers('wlth', this)" data-i18n="sort_wlth">ì¬ë ¥</button>
                    <button class="rank-tab-btn" onclick="renderUsers('agi', this)" data-i18n="sort_agi">ë¯¼ì²©</button>
                </div>
                <div class="user-list" id="user-list-container"></div>
            </section>

            <section id="settings" class="view-section">
                <h2 data-i18n="set_title">System Settings</h2>
                <div class="system-card">
                    <div class="setting-row">
                        <span data-i18n="set_lang">ì–¸ì–´ (Language)</span>
                        <select class="custom-select" onchange="changeLanguage(this.value)">
                            <option value="ko" selected>í•œêµ­ì–´</option>
                            <option value="en">English</option>
                            <option value="ja">æ—¥æœ¬èª</option>
                        </select>
                    </div>
                    <div class="setting-row">
                        <span data-i18n="set_theme">ë¼ì´íŠ¸ ëª¨ë“œ</span>
                        <label class="switch"><input type="checkbox" id="theme-toggle" onchange="changeTheme()"><span class="slider"></span></label>
                    </div>
                </div>
                <div class="system-card">
                    <div class="setting-row">
                        <span data-i18n="set_gps">ì•± ì‹¤í–‰ ì‹œ í˜„ìœ„ì¹˜ íƒìƒ‰</span>
                        <label class="switch"><input type="checkbox" id="gps-toggle" onchange="toggleGPS()"><span class="slider"></span></label>
                    </div>
                    <div class="setting-row" id="gps-status" style="font-size:0.7rem; color:var(--text-sub); display:none; justify-content:flex-end; padding-top:0;"></div>
                    
                    <div class="setting-row">
                        <span data-i18n="set_sync">ê±´ê°• ì•± ë™ê¸°í™”</span>
                        <label class="switch"><input type="checkbox" id="sync-toggle" onchange="toggleHealthSync()"><span class="slider"></span></label>
                    </div>
                    <div class="setting-row" id="sync-status" style="font-size:0.7rem; color:var(--neon-blue); display:none; justify-content:flex-end; padding-top:0; text-align:right;"></div>
                </div>
                <button class="btn-primary" style="background: #222; border: 1px solid var(--border-color); color: var(--neon-red);" onclick="logout()" data-i18n="set_logout">ë¡œê·¸ì•„ì›ƒ</button>
            </section>
        </main>

        <nav>
            <div class="nav-item active" onclick="switchTab('status', this)"><span class="nav-icon">ğŸ‘¤</span><span data-i18n="nav_status">ìƒíƒœì°½</span></div>
            <div class="nav-item" onclick="switchTab('quests', this)"><span class="nav-icon">ğŸ“œ</span><span data-i18n="nav_quest">í€˜ìŠ¤íŠ¸</span></div>
            <div class="nav-item" onclick="switchTab('dungeon', this)"><span class="nav-icon">âš”ï¸</span><span data-i18n="nav_dungeon">ë˜ì „</span></div>
            <div class="nav-item" onclick="switchTab('social', this)"><span class="nav-icon">ğŸ†</span><span data-i18n="nav_social">ì†Œì…œ</span></div>
            <div class="nav-item" onclick="switchTab('settings', this)"><span class="nav-icon">âš™ï¸</span><span data-i18n="nav_settings">ì„¤ì •</span></div>
        </nav>
    </div>

    <div class="modal-overlay" id="titleModal">
        <div class="modal-content">
            <div class="modal-header">
                <span data-i18n="modal_title">ì¹­í˜¸ ì´ë ¥ ì¡°íšŒ</span>
                <button class="modal-close" onclick="closeTitleModal()">Ã—</button>
            </div>
            <div class="history-list" id="history-list-container"></div>
        </div>
    </div>

    <script>
        // --- 0. ë¡œê·¸ì¸ ë° ì¸ì¦ ë¡œì§ (ì •ê·œì‹ ê²€ì¦ ì¶”ê°€) ---
        let isLoginMode = true;

        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (isLoggedIn === 'true') {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('app-container').style.display = 'flex';
                changeTheme(); loadPlayerName(); changeLanguage(currentLang); renderCalendar(); updatePointUI();
                drawRadarChart(); 
            } else {
                document.getElementById('login-screen').style.display = 'flex';
                document.getElementById('app-container').style.display = 'none';
            }
        }

        function toggleAuthMode() {
            isLoginMode = !isLoginMode;
            const btnSubmit = document.getElementById('btn-login-submit');
            const toggleText = document.getElementById('auth-toggle-text');
            const pwConfirm = document.getElementById('login-pw-confirm');
            const pwHint = document.getElementById('pw-hint');
            const disclaimerBox = document.getElementById('disclaimer-box');
            
            if(isLoginMode) {
                btnSubmit.setAttribute('data-i18n', 'btn_login_submit');
                toggleText.setAttribute('data-i18n', 'auth_toggle_signup');
                pwConfirm.style.display = 'none';
                pwHint.style.display = 'none';
                disclaimerBox.style.display = 'none';
            } else {
                btnSubmit.setAttribute('data-i18n', 'btn_signup_submit');
                toggleText.setAttribute('data-i18n', 'auth_toggle_login');
                pwConfirm.style.display = 'block';
                pwHint.style.display = 'block';
                disclaimerBox.style.display = 'block';
            }
            changeLanguage(currentLang); 
        }

        function simulateLogin() {
            const email = document.getElementById('login-email').value;
            const pw = document.getElementById('login-pw').value;
            const pwConfirm = document.getElementById('login-pw-confirm').value;

            // ê³µë°± ì²´í¬
            if(!email || !pw) { alert(i18n[currentLang].login_err_empty); return; }

            // ì´ë©”ì¼ ì •ê·œì‹ ê²€ì¦
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if(!emailRegex.test(email)) { alert(i18n[currentLang].login_err_email); return; }

            // íšŒì›ê°€ì… ì‹œ ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì¦
            if(!isLoginMode) {
                const hasUppercase = /[A-Z]/.test(pw);
                const specialChars = pw.match(/[^a-zA-Z0-9]/g) || [];
                if(pw.length < 8 || !hasUppercase || specialChars.length < 2) {
                    alert(i18n[currentLang].login_err_pw_req); return;
                }
                if(pw !== pwConfirm) { alert(i18n[currentLang].pw_mismatch); return; }
            }

            localStorage.setItem('isLoggedIn', 'true');
            checkLoginStatus();
        }

        function simulateGoogleLogin() {
            localStorage.setItem('isLoggedIn', 'true');
            checkLoginStatus();
        }

        function logout() {
            localStorage.removeItem('isLoggedIn');
            document.getElementById('login-email').value = '';
            document.getElementById('login-pw').value = '';
            document.getElementById('login-pw-confirm').value = '';
            
            isLoginMode = true; 
            document.getElementById('btn-login-submit').setAttribute('data-i18n', 'btn_login_submit');
            document.getElementById('auth-toggle-text').setAttribute('data-i18n', 'auth_toggle_signup');
            document.getElementById('login-pw-confirm').style.display = 'none';
            document.getElementById('pw-hint').style.display = 'none';
            document.getElementById('disclaimer-box').style.display = 'none';
            
            changeLanguage(currentLang);
            checkLoginStatus();
        }

        // --- 1. ë‹¤êµ­ì–´ ì‚¬ì „ (ì „ì²´ ë©”ë‰´ ë° Placeholder í¬í•¨) ---
        const i18n = {
            ko: {
                login_desc: "ì‹œìŠ¤í…œì— ì ‘ì†í•˜ì—¬ í˜„ì‹¤ì„ ê²Œì„ì²˜ëŸ¼.", btn_login_submit: "ì‹œìŠ¤í…œ ì ‘ì† (ë¡œê·¸ì¸)", btn_signup_submit: "ìƒˆ í”Œë ˆì´ì–´ ë“±ë¡ (íšŒì›ê°€ì…)", 
                btn_google_login: "Googleë¡œ ì‹œì‘", auth_toggle_signup: "ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? íšŒì›ê°€ì…", auth_toggle_login: "ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? ë¡œê·¸ì¸",
                ph_email: "ì´ë©”ì¼ (Email)", ph_pw: "ë¹„ë°€ë²ˆí˜¸ (Password)", ph_pw_conf: "ë¹„ë°€ë²ˆí˜¸ í™•ì¸ (Confirm Password)",
                pw_req_hint: "â€» ë¹„ë°€ë²ˆí˜¸: 8ìë¦¬ ì´ìƒ, ëŒ€ë¬¸ì 1ê°œ ì´ìƒ, íŠ¹ìˆ˜ë¬¸ì 2ê°œ ì´ìƒ í¬í•¨",
                disclaimer_txt: "â€» ê°€ì… ì‹œ ì´ìš©ì•½ê´€ ë° ë©´ì±…ì‚¬í•­ì— ë™ì˜í•˜ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤. ë³¸ ì•±ì€ ê±´ê°• ë³´ì¡° ëª©ì ì´ë©°, í€˜ìŠ¤íŠ¸ ìˆ˜í–‰ ì¤‘ ë°œìƒí•˜ëŠ” ì‹ ì²´ì  ë¶€ìƒì´ë‚˜ ì†í•´ì— ëŒ€í•´ ì¼ì ˆ ì±…ì„ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.",
                login_err_empty: "ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.", login_err_email: "ìœ íš¨í•œ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.", 
                login_err_pw_req: "ë¹„ë°€ë²ˆí˜¸ ì¡°ê±´(8ìë¦¬ ì´ìƒ, ëŒ€ë¬¸ì 1ê°œ ì´ìƒ, íŠ¹ìˆ˜ë¬¸ì 2ê°œ ì´ìƒ)ì„ ì¶©ì¡±í•´ì£¼ì„¸ìš”.", pw_mismatch: "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
                
                nav_status: "ìƒíƒœì°½", nav_quest: "í€˜ìŠ¤íŠ¸", nav_dungeon: "ë˜ì „", nav_social: "ì†Œì…œ", nav_settings: "ì„¤ì •",
                prof_name: "í”Œë ˆì´ì–´ (ë‚˜)", btn_hist: "ì¹­í˜¸ ì´ë ¥ ì¡°íšŒ", avail_pts: "ë³´ìœ  í¬ì¸íŠ¸", btn_lvlup: "ë ˆë²¨ ì—…", req_pts: "ìš”êµ¬ëŸ‰:",
                tot_score: "ì¢…í•© ìŠ¤ì½”ì–´", radar_title: "Stat Radar", stat_hint: "â€» ëŒ€ê¸° ìŠ¤íƒ¯ì€ ë ˆë²¨ì—… ì‹œ ë°˜ì˜ë¨",
                str: "ê·¼ë ¥", int: "ì§€ëŠ¥", cha: "ë§¤ë ¥", vit: "ì²´ë ¥", wlth: "ì¬ë ¥", agi: "ë¯¼ì²©",
                bar_str: "ê·¼ë ¥ (ë¬¼ë¦¬/ìš´ë™)", bar_int: "ì§€ëŠ¥ (í•™ìŠµ/ì¸ì§€)", bar_cha: "ë§¤ë ¥ (ì¸ë§¥/ì†Œí†µ)", bar_vit: "ì²´ë ¥ (ìˆ˜ë©´/íšŒë³µ)", bar_wlth: "ì¬ë ¥ (ìë³¸/íˆ¬ì)", bar_agi: "ë¯¼ì²© (ì‹œê°„/íš¨ìœ¨)",
                quest_title: "Daily Quests", quest_hint: "â€» ì™„ë£Œ ì‹œ +20P & ìŠ¤íƒ¯ +0.5 ëŒ€ê¸° ì ë¦½", cal_title: "ì£¼ê°„ ì§„ì²™ë„",
                raid_title: "Local Raid", raid_boss: "âš ï¸ ì„œìš¸ ê°•ë‚¨ ì—°í•© ë³´ìŠ¤ ì¶œí˜„", raid_desc1: '"í‡´ê·¼ê¸¸ì˜ ìœ í˜¹ì"ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.', raid_desc2: "ê·¼ì²˜ í—Œí„°ë“¤ê³¼ ì—°í•©í•˜ì—¬ 2ì‹œê°„ ë‚´<br>í•©ì‚° 50kmë¥¼ ë‹¬ì„±í•˜ê³  ì „ë¦¬í’ˆì„ íšë“í•˜ì„¸ìš”.", raid_part: "ì°¸ì—¬ ì¸ì›: ", raid_btn: "ë ˆì´ë“œ ì…ì¥í•˜ê¸°",
                soc_global: "ğŸ† ê¸€ë¡œë²Œ ë­í‚¹", soc_friend: "ğŸ‘¥ ë‚´ ì¹œêµ¬", sort_tot: "ì¢…í•©ìŠ¤ì½”ì–´", sort_str: "ê·¼ë ¥", sort_int: "ì§€ëŠ¥", sort_cha: "ë§¤ë ¥", sort_vit: "ì²´ë ¥", sort_wlth: "ì¬ë ¥", sort_agi: "ë¯¼ì²©",
                set_title: "System Settings", set_lang: "ì–¸ì–´ (Language)", set_theme: "ë¼ì´íŠ¸ ëª¨ë“œ", set_push: "í‘¸ì‹œ ì•Œë¦¼ ìˆ˜ì‹ ", set_gps: "ì•± ì‹¤í–‰ ì‹œ í˜„ìœ„ì¹˜ íƒìƒ‰", set_sync: "ê±´ê°• ì•± ë™ê¸°í™”", set_logout: "ë¡œê·¸ì•„ì›ƒ",
                no_friend: "ë“±ë¡ëœ ì¹œêµ¬ê°€ ì—†ìŠµë‹ˆë‹¤.", btn_add: "ì¹œêµ¬ ì¶”ê°€", btn_added: "ì¹œêµ¬ âœ“", gps_on: "ìœ„ì¹˜ ê¶Œí•œ í™œì„±í™”ë¨", gps_off: "ìœ„ì¹˜ íƒìƒ‰ ì¤‘ì§€ë¨", gps_err: "ìœ„ì¹˜ ì •ë³´ ì˜¤ë¥˜", modal_title: "ì¹­í˜¸ ì´ë ¥ ì¡°íšŒ",
                name_prompt: "ìƒˆë¡œìš´ ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”.\n(â€» 1ê°œì›”ì— 1íšŒë§Œ ë³€ê²½ ê°€ëŠ¥í•©ë‹ˆë‹¤.)", name_err: "ëª…ì¹­ ë³€ê²½ì€ 1ê°œì›”ì— í•œ ë²ˆë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.", sync_req: "ë™ê¸°í™” ìš”ì²­ ì¤‘...", sync_done: "ë™ê¸°í™” ì™„ë£Œ (í¬ì¸íŠ¸ ì§€ê¸‰)", sync_off: "ë™ê¸°í™” í•´ì œë¨"
            },
            en: {
                login_desc: "Access the system, gamify your life.", btn_login_submit: "System Access (Login)", btn_signup_submit: "Register Player (Sign Up)", 
                btn_google_login: "Continue with Google", auth_toggle_signup: "No account? Sign Up", auth_toggle_login: "Already have an account? Login",
                ph_email: "Email Address", ph_pw: "Password", ph_pw_conf: "Confirm Password",
                pw_req_hint: "â€» Password: 8+ chars, 1+ uppercase, 2+ special chars",
                disclaimer_txt: "â€» By signing up, you agree to our Disclaimer. This app does not provide medical advice and is not liable for any injuries during quests.",
                login_err_empty: "Please enter your email and password.", login_err_email: "Please enter a valid email address.",
                login_err_pw_req: "Password must be 8+ characters with at least 1 uppercase and 2 special characters.", pw_mismatch: "Passwords do not match.",
                
                nav_status: "Status", nav_quest: "Quests", nav_dungeon: "Dungeon", nav_social: "Social", nav_settings: "Settings",
                prof_name: "Player (Me)", btn_hist: "Title History", avail_pts: "Available Pts", btn_lvlup: "Level Up", req_pts: "Required:",
                tot_score: "Total Score", radar_title: "Stat Radar", stat_hint: "â€» Pending stats are applied upon Level Up.",
                str: "STR", int: "INT", cha: "CHA", vit: "VIT", wlth: "WLTH", agi: "AGI",
                bar_str: "STR (Physical)", bar_int: "INT (Cognitive)", bar_cha: "CHA (Social)", bar_vit: "VIT (Recovery)", bar_wlth: "WLTH (Capital)", bar_agi: "AGI (Efficiency)",
                quest_title: "Daily Quests", quest_hint: "â€» Earn +20P & +0.5 pending stat per quest", cal_title: "Weekly Progress",
                raid_title: "Local Raid", raid_boss: "âš ï¸ Gangnam Alliance Boss", raid_desc1: '"Predator of Laziness" detected.', raid_desc2: "Unite with nearby hunters to achieve<br>50km in 2 hours and get loot.", raid_part: "Participants: ", raid_btn: "Enter Raid",
                soc_global: "ğŸ† Global Rank", soc_friend: "ğŸ‘¥ My Friends", sort_tot: "Total", sort_str: "STR", sort_int: "INT", sort_cha: "CHA", sort_vit: "VIT", sort_wlth: "WLTH", sort_agi: "AGI",
                set_title: "System Settings", set_lang: "Language", set_theme: "Light Theme", set_push: "Push Notifications", set_gps: "Auto Location Tracking", set_sync: "Health App Sync", set_logout: "Logout",
                no_friend: "No friends registered.", btn_add: "Add Friend", btn_added: "Friend âœ“", gps_on: "Location tracking on", gps_off: "Location tracking off", gps_err: "Location Error", modal_title: "Title History",
                name_prompt: "Enter new player name.\n(Can be changed once a month)", name_err: "Name can only be changed once a month.", sync_req: "Requesting sync...", sync_done: "Sync complete", sync_off: "Sync disabled"
            },
            ja: {
                login_desc: "ã‚·ã‚¹ãƒ†ãƒ ã«æ¥ç¶šã—ã€ç¾å®Ÿã‚’ã‚²ãƒ¼ãƒ ã®ã‚ˆã†ã«ã€‚", btn_login_submit: "ã‚·ã‚¹ãƒ†ãƒ æ¥ç¶š (ãƒ­ã‚°ã‚¤ãƒ³)", btn_signup_submit: "æ–°è¦ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç™»éŒ²", 
                btn_google_login: "Googleã§ç¶šè¡Œ", auth_toggle_signup: "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ æ–°è¦ç™»éŒ²", auth_toggle_login: "ã™ã§ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ ãƒ­ã‚°ã‚¤ãƒ³",
                ph_email: "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹", ph_pw: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰", ph_pw_conf: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ (ç¢ºèªç”¨)",
                pw_req_hint: "â€» ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: 8æ–‡å­—ä»¥ä¸Šã€å¤§æ–‡å­—1ã¤ä»¥ä¸Šã€ç‰¹æ®Šæ–‡å­—2ã¤ä»¥ä¸Š",
                disclaimer_txt: "â€» ç™»éŒ²ã«ã‚ˆã‚Šå…è²¬äº‹é …ã«åŒæ„ã—ãŸã¨ã¿ãªã•ã‚Œã¾ã™ã€‚æœ¬ã‚¢ãƒ—ãƒªã¯åŒ»ç™‚çš„åŠ©è¨€ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ãªãã€ã‚¯ã‚¨ã‚¹ãƒˆä¸­ã®æ€ªæˆ‘ç­‰ã«ã¤ã„ã¦ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚",
                login_err_empty: "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚", login_err_email: "æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
                login_err_pw_req: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®æ¡ä»¶(8æ–‡å­—ä»¥ä¸Šã€å¤§æ–‡å­—1ã¤ä»¥ä¸Šã€ç‰¹æ®Šæ–‡å­—2ã¤ä»¥ä¸Š)ã‚’æº€ãŸã—ã¦ãã ã•ã„ã€‚", pw_mismatch: "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“ã€‚",

                nav_status: "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹", nav_quest: "ã‚¯ã‚¨ã‚¹ãƒˆ", nav_dungeon: "ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³", nav_social: "ã‚½ãƒ¼ã‚·ãƒ£ãƒ«", nav_settings: "è¨­å®š",
                prof_name: "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ (ç§)", btn_hist: "ç§°å·å±¥æ­´", avail_pts: "ä¿æœ‰ãƒã‚¤ãƒ³ãƒˆ", btn_lvlup: "ãƒ¬ãƒ™ãƒ«UP", req_pts: "å¿…è¦é‡:",
                tot_score: "ç·åˆã‚¹ã‚³ã‚¢", radar_title: "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¬ãƒ¼ãƒ€ãƒ¼", stat_hint: "â€» å¾…æ©Ÿã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¯ãƒ¬ãƒ™ãƒ«UPæ™‚ã«åæ˜ ã•ã‚Œã¾ã™ã€‚",
                str: "ç­‹åŠ›", int: "çŸ¥èƒ½", cha: "é­…åŠ›", vit: "ä½“åŠ›", wlth: "è²¡åŠ›", agi: "æ•æ·",
                bar_str: "ç­‹åŠ› (é‹å‹•)", bar_int: "çŸ¥èƒ½ (èªçŸ¥)", bar_cha: "é­…åŠ› (äººè„ˆ)", bar_vit: "ä½“åŠ› (å›å¾©)", bar_wlth: "è²¡åŠ› (è³‡æœ¬)", bar_agi: "æ•æ· (åŠ¹ç‡)",
                quest_title: "ãƒ‡ã‚¤ãƒªãƒ¼ã‚¯ã‚¨ã‚¹ãƒˆ", quest_hint: "â€» å®Œäº†ã§ +20P & å¾…æ©Ÿã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹+0.5", cal_title: "é€±é–“é€²æ—åº¦",
                raid_title: "ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¬ã‚¤ãƒ‰", raid_boss: "âš ï¸ æ±Ÿå—é€£åˆãƒœã‚¹å‡ºç¾", raid_desc1: "ã€Œæ€ æƒ°ã®æ•é£Ÿè€…ã€æ„ŸçŸ¥ã€‚", raid_desc2: "è¿‘ãã®ãƒãƒ³ã‚¿ãƒ¼ã¨é€£åˆã—ã¦2æ™‚é–“ä»¥å†…ã«<br>åˆè¨ˆ50kmã‚’é”æˆã—æˆ¦åˆ©å“ã‚’ç²å¾—ã›ã‚ˆã€‚", raid_part: "å‚åŠ äººæ•°: ", raid_btn: "å…¥å ´ã™ã‚‹",
                soc_global: "ğŸ† ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ©ãƒ³ã‚¯", soc_friend: "ğŸ‘¥ ãƒã‚¤ãƒ•ãƒ¬ãƒ³ãƒ‰", sort_tot: "ç·åˆ", sort_str: "ç­‹åŠ›", sort_int: "çŸ¥èƒ½", sort_cha: "é­…åŠ›", sort_vit: "ä½“åŠ›", sort_wlth: "è²¡åŠ›", sort_agi: "æ•æ·",
                set_title: "ã‚·ã‚¹ãƒ†ãƒ è¨­å®š", set_lang: "è¨€èª (Language)", set_theme: "ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰", set_push: "ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥å—ä¿¡", set_gps: "èµ·å‹•æ™‚ã®ä½ç½®æƒ…å ±å–å¾—", set_sync: "ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢ã‚¢ãƒ—ãƒªåŒæœŸ", set_logout: "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ",
                no_friend: "å‹é”ãŒã„ã¾ã›ã‚“ã€‚", btn_add: "å‹é”è¿½åŠ ", btn_added: "å‹é” âœ“", gps_on: "ä½ç½®æƒ…å ±æœ‰åŠ¹", gps_off: "ä½ç½®æƒ…å ±åœæ­¢", gps_err: "ä½ç½®æƒ…å ±ã‚¨ãƒ©ãƒ¼", modal_title: "ç§°å·å±¥æ­´",
                name_prompt: "æ–°ã—ã„ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\n(æœˆã«1å›ã®ã¿å¤‰æ›´å¯èƒ½)", name_err: "åå‰ã®å¤‰æ›´ã¯æœˆã«1å›ã®ã¿å¯èƒ½ã§ã™ã€‚", sync_req: "åŒæœŸã‚’è¦æ±‚ä¸­...", sync_done: "åŒæœŸå®Œäº†", sync_off: "åŒæœŸè§£é™¤"
            }
        };

        const titleVocab = {
            str: { ko: { pre: ["ê°•ì¸í•œ", "ê±°ì¹œ", "ë¶€ì„œì§€ì§€ ì•ŠëŠ”"], suf: ["ê³°", "ë°”ìœ„", "ê±°ì¸"] }, en: { pre: ["Strong", "Tough", "Unbreakable"], suf: ["Bear", "Rock", "Giant"] }, ja: { pre: ["å¼·é­ãª", "è’ã€…ã—ã„", "ç •ã‘ãªã„"], suf: ["ç†Š", "å²©", "å·¨äºº"] } },
            int: { ko: { pre: ["ì§€í˜œë¡œìš´", "ê¿°ëš«ì–´ë³´ëŠ”", "ê¹Šì€"], suf: ["ì˜¬ë¹¼ë¯¸", "í˜¸ìˆ˜", "í˜„ì"] }, en: { pre: ["Wise", "Piercing", "Deep"], suf: ["Owl", "Lake", "Sage"] }, ja: { pre: ["çŸ¥æµã®ã‚ã‚‹", "è¦‹æŠœã", "æ·±ã„"], suf: ["ãƒ•ã‚¯ãƒ­ã‚¦", "æ¹–", "è³¢è€…"] } },
            cha: { ko: { pre: ["ë§¤í˜¹ì ì¸", "ë¹›ë‚˜ëŠ”", "ì‚¬ëŒì„ ë„ëŠ”"], suf: ["ì—¬ìš°", "ë¶ˆê½ƒ", "ë³„"] }, en: { pre: ["Charming", "Shining", "Magnetic"], suf: ["Fox", "Flame", "Star"] }, ja: { pre: ["é­…åŠ›çš„ãª", "è¼ã", "æƒ¹ãã¤ã‘ã‚‹"], suf: ["ã‚­ãƒ„ãƒ", "ç‚", "æ˜Ÿ"] } },
            vit: { ko: { pre: ["ì§€ì¹˜ì§€ ì•ŠëŠ”", "ëˆì§ˆê¸´", "ìˆ¨ì‰¬ëŠ”"], suf: ["ê±°ë¶ì´", "ëŒ€ì§€", "ë¿Œë¦¬"] }, en: { pre: ["Tireless", "Persistent", "Breathing"], suf: ["Turtle", "Earth", "Root"] }, ja: { pre: ["ç–²ã‚Œãªã„", "ç²˜ã‚Šå¼·ã„", "æ¯ã¥ã"], suf: ["äº€", "å¤§åœ°", "æ ¹"] } },
            wlth:{ ko: { pre: ["í’ì¡±í•œ", "í™©ê¸ˆì„ ì¥”", "ê³„ì‚°í•˜ëŠ”"], suf: ["ë‘êº¼ë¹„", "íƒœì–‘", "ë³´ì„"] }, en: { pre: ["Abundant", "Golden", "Calculating"], suf: ["Toad", "Sun", "Gem"] }, ja: { pre: ["è±Šã‹ãª", "é»„é‡‘ã‚’æ¡ã‚‹", "è¨ˆç®—ã™ã‚‹"], suf: ["ãƒ’ã‚­ã‚¬ã‚¨ãƒ«", "å¤ªé™½", "å®çŸ³"] } },
            agi: { ko: { pre: ["ë‚ ìŒ˜", "ë°”ëŒì„ ê°€ë¥´ëŠ”", "ë³´ì´ì§€ ì•ŠëŠ”"], suf: ["í‘œë²”", "í™”ì‚´", "ë§¤"] }, en: { pre: ["Swift", "Wind-cleaving", "Unseen"], suf: ["Panther", "Arrow", "Hawk"] }, ja: { pre: ["ç´ æ—©ã„", "é¢¨ã‚’åˆ‡ã‚‹", "è¦‹ãˆãªã„"], suf: ["ãƒ’ãƒ§ã‚¦", "çŸ¢", "é·¹"] } }
        };

        // --- 2. ì‹œìŠ¤í…œ ìƒíƒœ (ê¸°ë³¸ê°’ 0 & ëŒ€ê¸° ìŠ¤íƒ¯) ---
        let currentLang = 'ko';
        let userLevel = 1;
        let userPoints = 50; 
        
        const statKeys = ['str', 'int', 'cha', 'vit', 'wlth', 'agi'];
        const myStats = { str: 0, int: 0, cha: 0, vit: 0, wlth: 0, agi: 0 };
        const pendingStats = { str: 0, int: 0, cha: 0, vit: 0, wlth: 0, agi: 0 };

        let titleHistory = [
            { level: 1, title: { ko: "ì‹ ê·œ ê°ì„±ì", en: "New Awakened", ja: "æ–°è¦è¦šé†’è€…" } }
        ];

        function loadPlayerName() {
            const savedName = localStorage.getItem('playerName');
            if (savedName) {
                document.getElementById('prof-name').textContent = savedName;
                document.getElementById('prof-name').removeAttribute('data-i18n'); 
            }
        }

        function changePlayerName() {
            const lastChanged = localStorage.getItem('lastNameChange');
            const now = new Date().getTime();
            const thirtyDays = 30 * 24 * 60 * 60 * 1000;

            if (lastChanged && (now - lastChanged) < thirtyDays) {
                const remain = Math.ceil((thirtyDays - (now - lastChanged)) / (1000*60*60*24));
                alert(`${i18n[currentLang].name_err} (${remain}ì¼ í›„ ê°€ëŠ¥)`);
                return;
            }

            const newName = prompt(i18n[currentLang].name_prompt);
            if (newName && newName.trim() !== "") {
                const finalName = newName.trim();
                document.getElementById('prof-name').textContent = finalName;
                document.getElementById('prof-name').removeAttribute('data-i18n');
                localStorage.setItem('lastNameChange', now.toString());
                localStorage.setItem('playerName', finalName);
                renderUsers(currentSortCriteria);
            }
        }

        function getReqPoints(level) { return Math.floor(100 * Math.pow(1.5, level - 1)); }

        function updatePointUI() {
            const reqPts = getReqPoints(userLevel);
            document.getElementById('sys-level').innerText = `Lv. ${userLevel}`;
            document.getElementById('display-pts').innerText = userPoints;
            document.getElementById('display-req-pts').innerText = reqPts;
            
            const btn = document.getElementById('btn-levelup');
            if(userPoints >= reqPts) {
                btn.disabled = false; btn.style.background = "var(--neon-gold)"; btn.style.color = "black"; btn.style.boxShadow = "0 0 15px var(--neon-gold)";
            } else {
                btn.disabled = true; btn.style.background = "#444"; btn.style.color = "#777"; btn.style.boxShadow = "none";
            }
            document.getElementById('prof-title-badge').innerText = titleHistory[titleHistory.length - 1].title[currentLang];
            
            statKeys.forEach(k => {
                const pendEl = document.getElementById(`pendVal_${k}`);
                if (pendingStats[k] > 0) pendEl.textContent = `(+${pendingStats[k]})`;
                else if (pendingStats[k] < 0) pendEl.textContent = `(${pendingStats[k]})`;
                else pendEl.textContent = "";
            });
        }

        function generateTitle() {
            let sortedStats = statKeys.map(k => ({ key: k, val: myStats[k] })).sort((a, b) => b.val - a.val);
            const top1 = sortedStats[0].key; 
            const top2 = sortedStats[1].key; 
            const randPre = Math.floor(Math.random() * 3);
            const randSuf = Math.floor(Math.random() * 3);
            return {
                ko: `${titleVocab[top1].ko.pre[randPre]} ${titleVocab[top2].ko.suf[randSuf]}`,
                en: `${titleVocab[top1].en.pre[randPre]} ${titleVocab[top2].en.suf[randSuf]}`,
                ja: `${titleVocab[top1].ja.pre[randPre]} ${titleVocab[top2].ja.suf[randSuf]}`
            };
        }

        function processLevelUp() {
            const reqPts = getReqPoints(userLevel);
            if(userPoints >= reqPts) {
                userPoints -= reqPts;
                userLevel++;
                
                statKeys.forEach(k => {
                    myStats[k] = Math.min(100, myStats[k] + pendingStats[k]);
                    pendingStats[k] = 0;
                });

                const newTitleObj = generateTitle();
                titleHistory.push({ level: userLevel, title: newTitleObj });

                updatePointUI(); drawRadarChart(); renderHistoryModal(); renderUsers(currentSortCriteria);
                alert(`Level Up! [Lv.${userLevel}]\nìƒˆë¡œìš´ ì¹­í˜¸ íšë“: ${newTitleObj[currentLang]}`);
            }
        }

        function openTitleModal() { renderHistoryModal(); document.getElementById('titleModal').style.display = 'flex'; }
        function closeTitleModal() { document.getElementById('titleModal').style.display = 'none'; }
        function renderHistoryModal() {
            const container = document.getElementById('history-list-container'); container.innerHTML = '';
            [...titleHistory].reverse().forEach(hist => {
                const item = document.createElement('div'); item.className = 'history-item';
                item.innerHTML = `<span class="hist-lvl">Lv. ${hist.level}</span><span class="hist-title">${hist.title[currentLang]}</span>`;
                container.appendChild(item);
            });
        }

        // ì „ì²´ ë©”ë‰´ ë° í”Œë ˆì´ìŠ¤í™€ë” ë‹¤êµ­ì–´ ì ìš© ìµœì í™”
        function changeLanguage(langCode) {
            currentLang = langCode;
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (i18n[currentLang][key]) el.innerHTML = i18n[currentLang][key];
            });
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (i18n[currentLang][key]) el.setAttribute('placeholder', i18n[currentLang][key]);
            });

            // ì•±ì´ í™”ë©´ì— ë–  ìˆì„ ë•Œë§Œ ì°¨íŠ¸ ë Œë”ë§ í˜¸ì¶œ
            if(document.getElementById('app-container').style.display !== 'none') {
                drawRadarChart(); renderUsers(currentSortCriteria); renderQuestList(); updatePointUI();
                if(document.getElementById('titleModal').style.display === 'flex') renderHistoryModal();
                loadPlayerName();
            }
        }

        function switchTab(tabId, el) {
            document.querySelectorAll('.view-section').forEach(s => s.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
            if(tabId === 'social') renderUsers(currentSortCriteria);
            if(tabId === 'status') { drawRadarChart(); updatePointUI(); }
            if(tabId === 'quests') { renderQuestList(); renderCalendar(); }
        }

        function changeTheme() {
            const isLight = document.getElementById('theme-toggle').checked;
            document.documentElement.setAttribute('data-theme', isLight ? 'light' : '');
            let themeMeta = document.querySelector('meta[name="theme-color"]') || document.createElement('meta');
            themeMeta.name = "theme-color"; themeMeta.content = isLight ? "#ffffff" : "#050508";
            document.head.appendChild(themeMeta);
        }

        // --- 4. ë ˆì´ë” ì°¨íŠ¸ ë Œë”ë§ ---
        function drawRadarChart() {
            const centerX = 50, centerY = 50, radius = 33; 
            const angles = []; for(let i=0; i<6; i++) angles.push(-Math.PI / 2 + (i * Math.PI / 3));

            const gridGroup = document.getElementById('radarGrid'); const axesGroup = document.getElementById('radarAxes');
            gridGroup.innerHTML = ''; axesGroup.innerHTML = '';
            
            for (let level = 1; level <= 5; level++) {
                const r = radius * (level / 5); let points = "";
                for (let i = 0; i < 6; i++) points += `${centerX + r * Math.cos(angles[i])},${centerY + r * Math.sin(angles[i])} `;
                const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                polygon.setAttribute('points', points.trim()); polygon.setAttribute('class', 'radar-bg-line');
                gridGroup.appendChild(polygon);
            }

            for (let i = 0; i < 6; i++) {
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', centerX); line.setAttribute('y1', centerY);
                line.setAttribute('x2', centerX + radius * Math.cos(angles[i])); line.setAttribute('y2', centerY + radius * Math.sin(angles[i]));
                line.setAttribute('class', 'radar-bg-line'); axesGroup.appendChild(line);
            }

            let dataPoints = "";
            const pointsGroup = document.getElementById('radarPoints'); const labelsGroup = document.getElementById('radarLabels');
            pointsGroup.innerHTML = ''; labelsGroup.innerHTML = '';

            let totalSum = 0;
            for (let i = 0; i < 6; i++) {
                const key = statKeys[i]; const val = myStats[key]; totalSum += val;
                
                const r = radius * (val / 100);
                const x = centerX + r * Math.cos(angles[i]); const y = centerY + r * Math.sin(angles[i]);
                dataPoints += `${x},${y} `;

                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', x); circle.setAttribute('cy', y); circle.setAttribute('r', '1.2'); circle.setAttribute('class', 'radar-point');
                pointsGroup.appendChild(circle);

                const labelRadius = radius + 9; 
                const lx = centerX + labelRadius * Math.cos(angles[i]); const ly = centerY + labelRadius * Math.sin(angles[i]) + 2; 

                let anchor = "middle"; if(i===1 || i===2) anchor = "start"; if(i===4 || i===5) anchor = "end";   

                const textName = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                textName.setAttribute('x', lx); textName.setAttribute('y', ly - 3);
                textName.setAttribute('text-anchor', anchor); textName.setAttribute('class', 'radar-label'); textName.textContent = i18n[currentLang][key];

                const textVal = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                textVal.setAttribute('x', lx); textVal.setAttribute('y', ly + 4);
                textVal.setAttribute('text-anchor', anchor); textVal.setAttribute('class', 'radar-value'); textVal.textContent = val;

                labelsGroup.appendChild(textName); labelsGroup.appendChild(textVal);
                
                const barValEl = document.getElementById(`barVal_${key}`);
                if(barValEl) barValEl.textContent = val;
                const barFillEl = document.getElementById(`barFill_${key}`);
                if(barFillEl) setTimeout(() => { barFillEl.style.width = `${val}%`; }, 100);
            }

            const playerPolygon = document.getElementById('playerPolygon');
            if(!playerPolygon.getAttribute('points')) {
                playerPolygon.setAttribute('points', "50,50 50,50 50,50 50,50 50,50 50,50"); 
            }
            setTimeout(() => { playerPolygon.setAttribute('points', dataPoints.trim()); }, 50);
            document.getElementById('totalScore').innerHTML = `${totalSum}`;
        }

        // --- 5. í€˜ìŠ¤íŠ¸ ë°ì´í„° & ìº˜ë¦°ë” ---
        const weeklyQuestData = [
            [ { stat: "STR", title: {ko:"íœ´ì‹ê³¼ ì‚°ì±…", en:"Rest & Walk", ja:"ä¼‘æ¯ã¨æ•£æ­©"}, desc: {ko:"30ë¶„ ê±·ê¸°", en:"30 min walk", ja:"30åˆ†æ­©è¡Œ"} }, { stat: "STR", title: {ko:"ì½”ì–´ ê°•í™”", en:"Core Strength", ja:"ã‚³ã‚¢å¼·åŒ–"}, desc: {ko:"í”Œë­í¬ 3ì„¸íŠ¸", en:"3 plank sets", ja:"ãƒ—ãƒ©ãƒ³ã‚¯3å›"} }, { stat: "INT", title: {ko:"ì£¼ê°„ ê³„íš", en:"Weekly Plan", ja:"é€±é–“è¨ˆç”»"}, desc: {ko:"ì¼ì • ì •ë¦¬", en:"Plan schedule", ja:"äºˆå®šæ•´ç†"} }, { stat: "INT", title: {ko:"ë…ì„œ íƒ€ì„", en:"Reading", ja:"èª­æ›¸"}, desc: {ko:"ë¹„ë¬¸í•™ 1ì±•í„°", en:"Read 1 chapter", ja:"1ç« èª­ã‚€"} }, { stat: "CHA", title: {ko:"ìê¸° ë°˜ì„±", en:"Reflection", ja:"è‡ªå·±åçœ"}, desc: {ko:"ì¼ê¸° ì‘ì„±", en:"Write journal", ja:"æ—¥è¨˜ä½œæˆ"} }, { stat: "CHA", title: {ko:"ì™¸ì  ì •ëˆ", en:"Grooming", ja:"èº«ã ã—ãªã¿"}, desc: {ko:"ì˜· ë‹¤ë¦¼ì§ˆ", en:"Iron clothes", ja:"æœã®æº–å‚™"} }, { stat: "VIT", title: {ko:"ë°˜ì‹ ìš•", en:"Bath", ja:"åŠèº«æµ´"}, desc: {ko:"í”¼ë¡œ í’€ê¸°", en:"Relieve fatigue", ja:"ç–²åŠ´å›å¾©"} }, { stat: "VIT", title: {ko:"ì˜ì–‘ ê· í˜•", en:"Diet", ja:"æ „é¤Š"}, desc: {ko:"ì±„ì†Œ ìœ„ì£¼ ì‹ë‹¨", en:"Veg-heavy meal", ja:"é‡èœä¸­å¿ƒé£Ÿäº‹"} }, { stat: "WLTH", title: {ko:"ì›”ê°„ ëª©í‘œ", en:"Monthly Goal", ja:"æœˆé–“ç›®æ¨™"}, desc: {ko:"ì €ì¶• ëª©í‘œ", en:"Set saving goal", ja:"è²¯è“„ç›®æ¨™"} }, { stat: "WLTH", title: {ko:"ìì‚° ë¦¬ë·°", en:"Net Worth", ja:"è³‡ç”£ç¢ºèª"}, desc: {ko:"ìì‚° ì ê²€", en:"Check net worth", ja:"è³‡ç”£ç‚¹æ¤œ"} }, { stat: "AGI", title: {ko:"ë””ì§€í„¸ ì •ë¦¬", en:"Declutter", ja:"ãƒ‡ã‚¸ã‚¿ãƒ«æ•´ç†"}, desc: {ko:"ì•± ì‚­ì œ", en:"Delete apps", ja:"ã‚¢ãƒ—ãƒªå‰Šé™¤"} }, { stat: "AGI", title: {ko:"ë£¨í‹´ ì„¸íŒ…", en:"Alarms", ja:"ã‚¢ãƒ©ãƒ¼ãƒ "}, desc: {ko:"ì•ŒëŒ ì„¸íŒ…", en:"Set alarm", ja:"æº–å‚™"} } ],
            [ { stat: "STR", title: {ko:"1ë§Œë³´ ë‹¬ì„±", en:"10k Steps", ja:"1ä¸‡æ­©"}, desc: {ko:"ê±·ê¸° ëŠ˜ë¦¬ê¸°", en:"Walk more", ja:"æ­©è¡Œè¿½åŠ "} }, { stat: "STR", title: {ko:"í‘¸ì‰¬ì—…", en:"Pushups", ja:"è…•ç«‹ã¦ä¼ã›"}, desc: {ko:"í‘¸ì‰¬ì—… 3ì„¸íŠ¸", en:"3 sets", ja:"3ã‚»ãƒƒãƒˆ"} }, { stat: "INT", title: {ko:"ë…ì„œ ìŠµê´€", en:"Reading", ja:"èª­æ›¸ç¿’æ…£"}, desc: {ko:"10í˜ì´ì§€ ì½ê¸°", en:"Read 10 pages", ja:"10ãƒšãƒ¼ã‚¸"} }, { stat: "INT", title: {ko:"ì§€ì‹ ì²­ì·¨", en:"Podcast", ja:"ãƒãƒƒãƒ‰ã‚­ãƒ£ã‚¹ãƒˆ"}, desc: {ko:"ê²½ì œ íŒŸìºìŠ¤íŠ¸", en:"Eco podcast", ja:"çµŒæ¸ˆè´å–"} }, { stat: "CHA", title: {ko:"ê°ì‚¬ í‘œí˜„", en:"Gratitude", ja:"æ„Ÿè¬"}, desc: {ko:"ë™ë£Œì—ê²Œ ê°ì‚¬", en:"Thank a colleague", ja:"åŒåƒšã«æ„Ÿè¬"} }, { stat: "CHA", title: {ko:"ìŠ¤í‚¨ì¼€ì–´", en:"Skincare", ja:"ã‚¹ã‚­ãƒ³ã‚±ã‚¢"}, desc: {ko:"ë³´ìŠµì œ ë°”ë¥´ê¸°", en:"Apply lotion", ja:"ä¿æ¹¿"} }, { stat: "VIT", title: {ko:"ìˆ˜ë¶„ ì¶©ì „", en:"Hydration", ja:"æ°´åˆ†è£œçµ¦"}, desc: {ko:"ë¬¼ 2ë¦¬í„°", en:"Drink 2L water", ja:"æ°´2L"} }, { stat: "VIT", title: {ko:"ë©˜íƒˆ ì¼€ì–´", en:"Meditation", ja:"ç‘æƒ³"}, desc: {ko:"10ë¶„ ëª…ìƒ", en:"10 mins med", ja:"10åˆ†ç‘æƒ³"} }, { stat: "WLTH", title: {ko:"ë¬´ì§€ì¶œ", en:"No Spend", ja:"ç„¡æ”¯å‡º"}, desc: {ko:"ì†Œë¹„ ì°¸ê¸°", en:"Avoid spending", ja:"æ¶ˆè²»æˆ‘æ…¢"} }, { stat: "WLTH", title: {ko:"ì‹œí™© ì²´í¬", en:"Market", ja:"å¸‚æ³"}, desc: {ko:"ê¸°ì‚¬ ìŠ¤í¬ë©", en:"Finance article", ja:"é‡‘èè¨˜äº‹"} }, { stat: "AGI", title: {ko:"ìš°ì„ ìˆœìœ„", en:"Prioritize", ja:"å„ªå…ˆé †ä½"}, desc: {ko:"Top 3 ì—…ë¬´", en:"Top 3 tasks", ja:"ä¸Šä½3æ¥­å‹™"} }, { stat: "AGI", title: {ko:"ë½€ëª¨ë„ë¡œ", en:"Pomodoro", ja:"ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­"}, desc: {ko:"30ë¶„ ì§‘ì¤‘", en:"30 min focus", ja:"30åˆ†é›†ä¸­"} } ],
            [ { stat: "STR", title: {ko:"ì¤‘ëŸ‰ íƒ€ê²©", en:"Weights", ja:"ã‚¦ã‚§ã‚¤ãƒˆ"}, desc: {ko:"30ë¶„ ì›¨ì´íŠ¸", en:"30 min lift", ja:"30åˆ†"} }, { stat: "STR", title: {ko:"ë‹¨ë°±ì§ˆ", en:"Protein", ja:"ã‚¿ãƒ³ãƒ‘ã‚¯è³ª"}, desc: {ko:"ë‹¨ë°±ì§ˆ ì‹ì‚¬", en:"Protein meal", ja:"é£Ÿäº‹"} }, { stat: "INT", title: {ko:"ë‹¨ì–´ ìˆ˜ì§‘", en:"Vocab", ja:"å˜èª"}, desc: {ko:"ìƒˆ ë‹¨ì–´ 3ê°œ", en:"3 new words", ja:"æ–°å˜èª3ã¤"} }, { stat: "INT", title: {ko:"ì—…ê³„ ë™í–¥", en:"Trend", ja:"ãƒˆãƒ¬ãƒ³ãƒ‰"}, desc: {ko:"ë¸”ë¡œê·¸ ì½ê¸°", en:"Read blog", ja:"ãƒ–ãƒ­ã‚°"} }, { stat: "CHA", title: {ko:"ì¹­ì°¬í•˜ê¸°", en:"Compliment", ja:"è¤’ã‚ã‚‹"}, desc: {ko:"ì¥ì  ì¹­ì°¬", en:"Praise someone", ja:"é•·æ‰€ã‚’è¤’ã‚ã‚‹"} }, { stat: "CHA", title: {ko:"ì•„ì´ì»¨íƒ", en:"Eye Contact", ja:"ã‚¢ã‚¤ã‚³ãƒ³ã‚¿ã‚¯ãƒˆ"}, desc: {ko:"ëˆˆ ë§ì¶”ê¸°", en:"Make eye contact", ja:"ç›®ã‚’åˆã‚ã›ã‚‹"} }, { stat: "VIT", title: {ko:"ìˆ˜ë©´", en:"Sleep", ja:"ç¡çœ "}, desc: {ko:"7ì‹œê°„ í™•ë³´", en:"Sleep 7+ hrs", ja:"7æ™‚é–“"} }, { stat: "VIT", title: {ko:"ì¹´í˜ì¸ í†µì œ", en:"No Caffeine", ja:"ã‚«ãƒ•ã‚§ã‚¤ãƒ³æ¸›"}, desc: {ko:"ì˜¤í›„ 2ì‹œ ì´í›„ X", en:"None after 2pm", ja:"åˆå¾Œãªã—"} }, { stat: "WLTH", title: {ko:"ê°€ê³„ë¶€", en:"Expense Track", ja:"å®¶è¨ˆç°¿"}, desc: {ko:"ì§€ì¶œ ë‚´ì—­ ì •ë¦¬", en:"Track daily", ja:"æ”¯å‡ºæ•´ç†"} }, { stat: "WLTH", title: {ko:"ì†Œì•¡ ì €ì¶•", en:"Micro Save", ja:"å°‘é¡è²¯é‡‘"}, desc: {ko:"ì—¬ìœ³ëˆ ì €ì¶•", en:"Save small amt", ja:"è²¯è“„"} }, { stat: "AGI", title: {ko:"ì‹¬ë°•ìˆ˜", en:"HR Up", ja:"å¿ƒæ‹æ•°"}, desc: {ko:"15ë¶„ ëŸ¬ë‹", en:"15 min run", ja:"15åˆ†ãƒ©ãƒ³"} }, { stat: "AGI", title: {ko:"ì¸ë°•ìŠ¤ ì œë¡œ", en:"Inbox Zero", ja:"å—ä¿¡ãƒˆãƒ¬ã‚¤"}, desc: {ko:"ë°€ë¦° ë‹µì¥", en:"Clear inbox", ja:"è¿”ä¿¡"} } ],
            [ { stat: "STR", title: {ko:"í•˜ì²´ ê°•í™”", en:"Leg Day", ja:"ä¸‹åŠèº«"}, desc: {ko:"ê³„ë‹¨ ì˜¤ë¥´ê¸°", en:"Stairs", ja:"éšæ®µ"} }, { stat: "STR", title: {ko:"ìŠ¤íŠ¸ë ˆì¹­", en:"Stretch", ja:"ã‚¹ãƒˆãƒ¬ãƒƒãƒ"}, desc: {ko:"ì „ì‹  10ë¶„", en:"10 mins", ja:"10åˆ†"} }, { stat: "INT", title: {ko:"ì¸ì‚¬ì´íŠ¸", en:"Insight", ja:"ã‚¤ãƒ³ã‚µã‚¤ãƒˆ"}, desc: {ko:"TED ê°•ì—°", en:"Watch TED", ja:"TED"} }, { stat: "INT", title: {ko:"ê¸°ë¡", en:"Record", ja:"è¨˜éŒ²"}, desc: {ko:"ë°°ìš´ ì  ìš”ì•½", en:"1 line summary", ja:"1è¡Œè¦ç´„"} }, { stat: "CHA", title: {ko:"ë„¤íŠ¸ì›Œí‚¹", en:"Network", ja:"ãƒãƒƒãƒˆ"}, desc: {ko:"SNS í¬ìŠ¤íŒ…", en:"Post on SNS", ja:"SNSæŠ•ç¨¿"} }, { stat: "CHA", title: {ko:"ë¯¸ì†Œ", en:"Smile", ja:"ç¬‘é¡”"}, desc: {ko:"ë¯¸ì†Œ ì—°ìŠµ", en:"Smile practice", ja:"ç·´ç¿’"} }, { stat: "VIT", title: {ko:"ë‹¹ë¥˜ ì œí•œ", en:"No Sugar", ja:"ç³–è³ªåˆ¶é™"}, desc: {ko:"ë‹¨ê²ƒ í”¼í•˜ê¸°", en:"Avoid sweets", ja:"é¿ã‘ã‚‹"} }, { stat: "VIT", title: {ko:"ì‹í›„ ì‚°ì±…", en:"Walk", ja:"æ•£æ­©"}, desc: {ko:"10ë¶„ ê±·ê¸°", en:"10 min walk", ja:"10åˆ†æ­©è¡Œ"} }, { stat: "WLTH", title: {ko:"ê²½ì œ ì§€ì‹", en:"Study", ja:"å‹‰å¼·"}, desc: {ko:"ìì‚° ê³µë¶€", en:"Learn crypto", ja:"è³‡ç”£å‹‰å¼·"} }, { stat: "WLTH", title: {ko:"í¬íŠ¸í´ë¦¬ì˜¤", en:"Portfolio", ja:"ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª"}, desc: {ko:"ìˆ˜ìµë¥  ì ê²€", en:"Check returns", ja:"åç›Šç‚¹æ¤œ"} }, { stat: "AGI", title: {ko:"íƒ€ì„ ë¸”ë¡œí‚¹", en:"Time Block", ja:"æ™‚é–“ç®¡ç†"}, desc: {ko:"ë‚´ì¼ ì¼ì •", en:"Plan tmrw", ja:"äºˆå®š"} }, { stat: "AGI", title: {ko:"ê³µê°„ ì •ë¦¬", en:"Clean", ja:"ç‰‡ä»˜ã‘"}, desc: {ko:"5ë¶„ ì •ë¦¬", en:"5 min clean", ja:"5åˆ†"} } ],
            [ { stat: "STR", title: {ko:"ë“± ê·¼ìœ¡", en:"Back", ja:"èƒŒç­‹"}, desc: {ko:"í„±ê±¸ì´", en:"Pullups", ja:"æ‡¸å‚"} }, { stat: "STR", title: {ko:"ë°”ë¥¸ ìì„¸", en:"Posture", ja:"å§¿å‹¢"}, desc: {ko:"ê±°ë¶ëª© êµì •", en:"Fix neck", ja:"é¦–çŸ¯æ­£"} }, { stat: "INT", title: {ko:"ë…¼ë¦¬ë ¥", en:"Logic", ja:"è«–ç†"}, desc: {ko:"í¼ì¦ í’€ê¸°", en:"Puzzles", ja:"ãƒ‘ã‚ºãƒ«"} }, { stat: "INT", title: {ko:"ë³µìŠµ", en:"Review", ja:"å¾©ç¿’"}, desc: {ko:"ë©”ëª¨ ì¬í™•ì¸", en:"Review notes", ja:"ãƒ¡ãƒ¢ç¢ºèª"} }, { stat: "CHA", title: {ko:"ê°€ì¡± í†µí™”", en:"Call", ja:"é›»è©±"}, desc: {ko:"ì•ˆë¶€ ë¬»ê¸°", en:"Call family", ja:"é€£çµ¡"} }, { stat: "CHA", title: {ko:"í–¥ê¸°", en:"Scent", ja:"é¦™ã‚Š"}, desc: {ko:"í–¥ìˆ˜ ì‚¬ìš©", en:"Use perfume", ja:"é¦™æ°´"} }, { stat: "VIT", title: {ko:"ë””í†¡ìŠ¤", en:"Detox", ja:"ãƒ‡ãƒˆãƒƒã‚¯ã‚¹"}, desc: {ko:"ìê¸° ì „ í° ë„ê¸°", en:"No phone", ja:"ã‚¹ãƒãƒ›ã‚ªãƒ•"} }, { stat: "VIT", title: {ko:"ì‹¬í˜¸í¡", en:"Breath", ja:"å‘¼å¸"}, desc: {ko:"4-7-8 í˜¸í¡", en:"Deep breath", ja:"æ·±å‘¼å¸"} }, { stat: "WLTH", title: {ko:"êµ¬ë… ì ê²€", en:"Subs", ja:"ã‚µãƒ–ã‚¹ã‚¯"}, desc: {ko:"ì•ˆ ì“°ëŠ” í•´ì§€", en:"Cancel unused", ja:"è§£ç´„"} }, { stat: "WLTH", title: {ko:"ì‚¬ì´ë“œ í—ˆìŠ¬", en:"Hustle", ja:"å‰¯æ¥­"}, desc: {ko:"ìˆ˜ì… êµ¬ìƒ", en:"Income idea", ja:"ã‚¢ã‚¤ãƒ‡ã‚¢"} }, { stat: "AGI", title: {ko:"ë”ë¸” ë½€ëª¨ë„ë¡œ", en:"Focus", ja:"é›†ä¸­"}, desc: {ko:"1ì‹œê°„ ì§‘ì¤‘", en:"1 hr focus", ja:"1æ™‚é–“"} }, { stat: "AGI", title: {ko:"2ë¶„ ë£°", en:"2-Min", ja:"2åˆ†"}, desc: {ko:"ì¦‰ì‹œ í•˜ê¸°", en:"Do it now", ja:"ã™ãã‚„ã‚‹"} } ],
            [ { stat: "STR", title: {ko:"ì „ì‹  ìš´ë™", en:"Full Body", ja:"å…¨èº«"}, desc: {ko:"ìŠ¤ì¿¼íŠ¸+ë²„í”¼", en:"Squat+Burpee", ja:"ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆ"} }, { stat: "STR", title: {ko:"ë¹„íƒ€ë¯¼", en:"Vitamin", ja:"ãƒ“ã‚¿ãƒŸãƒ³"}, desc: {ko:"ì˜ì–‘ì œ ì„­ì·¨", en:"Take pills", ja:"ã‚µãƒ—ãƒª"} }, { stat: "INT", title: {ko:"êµì–‘", en:"Culture", ja:"æ•™é¤Š"}, desc: {ko:"ë‹¤í ì‹œì²­", en:"Watch doc", ja:"ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ã‚¿ãƒªãƒ¼"} }, { stat: "INT", title: {ko:"ë”¥ ì›Œí¬", en:"Deep Work", ja:"æ²¡é ­"}, desc: {ko:"1ì‹œê°„ í•™ìŠµ", en:"1 hr study", ja:"1æ™‚é–“å­¦ç¿’"} }, { stat: "CHA", title: {ko:"ë„ì›€ ì£¼ê¸°", en:"Help", ja:"åŠ©ã‘"}, desc: {ko:"ë™ë£Œ ë•ê¸°", en:"Help someone", ja:"æ‰‹ä¼ã†"} }, { stat: "CHA", title: {ko:"ê²½ì²­", en:"Listen", ja:"å‚¾è´"}, desc: {ko:"ë§ ëŠì§€ ì•Šê¸°", en:"Don't interrupt", ja:"é®ã‚‰ãªã„"} }, { stat: "VIT", title: {ko:"ìŒì£¼ ì¡°ì ˆ", en:"Control", ja:"ç¯€é…’"}, desc: {ko:"ìˆ  ì¤„ì´ê¸°", en:"Drink less", ja:"æ¸›ã‚‰ã™"} }, { stat: "VIT", title: {ko:"ì•ˆêµ¬ íœ´ì‹", en:"Eye Rest", ja:"ç›®ã®ä¼‘æ¯"}, desc: {ko:"ë¨¼ ê³³ ë³´ê¸°", en:"Look away", ja:"é ãã‚’è¦‹ã‚‹"} }, { stat: "WLTH", title: {ko:"ì£¼ê°„ ì˜ˆì‚°", en:"Budget", ja:"äºˆç®—"}, desc: {ko:"ì´ˆê³¼ í™•ì¸", en:"Check budget", ja:"ç¢ºèª"} }, { stat: "WLTH", title: {ko:"ìë™ ì´ì²´", en:"Auto", ja:"è‡ªå‹•æŒ¯æ›¿"}, desc: {ko:"ì ê¸ˆ í™•ì¸", en:"Check auto-save", ja:"ç¢ºèª"} }, { stat: "AGI", title: {ko:"ì£¼ê°„ ë¦¬ë·°", en:"Review", ja:"æŒ¯ã‚Šè¿”ã‚Š"}, desc: {ko:"ë‹¬ì„±ë¥  ì²´í¬", en:"Check goals", ja:"é”æˆç‡"} }, { stat: "AGI", title: {ko:"ì£¼ë§ ê³„íš", en:"Plan", ja:"é€±æœ«è¨ˆç”»"}, desc: {ko:"ì¼ì • ì¡ê¸°", en:"Set plans", ja:"äºˆå®š"} } ],
            [ { stat: "STR", title: {ko:"ì•¼ì™¸ ëŸ¬ë‹", en:"Run", ja:"ãƒ©ãƒ³"}, desc: {ko:"5km ì¡°ê¹…", en:"5km jog", ja:"5km"} }, { stat: "STR", title: {ko:"ìš”ê°€", en:"Yoga", ja:"ãƒ¨ã‚¬"}, desc: {ko:"15ë¶„ ìœ ì—°ì„±", en:"15 min flex", ja:"15åˆ†"} }, { stat: "INT", title: {ko:"ì·¨ë¯¸", en:"Hobby", ja:"è¶£å‘³"}, desc: {ko:"ìœ íŠœë¸Œ 30ë¶„", en:"30 min YT", ja:"30åˆ†"} }, { stat: "INT", title: {ko:"ë‡Œ íœ´ì‹", en:"Brain Rest", ja:"è„³ä¼‘æ¯"}, desc: {ko:"í™œì ì—†ëŠ” ì‹œê°„", en:"No text", ja:"æ´»å­—ãªã—"} }, { stat: "CHA", title: {ko:"ì§€ì¸ ë§Œë‚¨", en:"Meet", ja:"ä¼šã†"}, desc: {ko:"ì¹œêµ¬ ì—°ë½", en:"Contact friend", ja:"é€£çµ¡"} }, { stat: "CHA", title: {ko:"ì·¨í–¥ ê³µìœ ", en:"Share", ja:"å…±æœ‰"}, desc: {ko:"ì¶”ì²œí•˜ê¸°", en:"Recommend", ja:"æ¨è–¦"} }, { stat: "VIT", title: {ko:"ë‚®ì ", en:"Nap", ja:"æ˜¼å¯"}, desc: {ko:"íŒŒì›Œ ë‚®ì ", en:"Power nap", ja:"ä»®çœ "} }, { stat: "VIT", title: {ko:"í–‡ë¹› ì¬ê¸°", en:"Sun", ja:"æ—¥å…‰æµ´"}, desc: {ko:"15ë¶„ ì•¼ì™¸", en:"15 mins out", ja:"15åˆ†"} }, { stat: "WLTH", title: {ko:"ë¶€ë™ì‚°/ì„ì¥", en:"Real Estate", ja:"ä¸å‹•ç”£"}, desc: {ko:"ì‹œì„¸ ë³´ê¸°", en:"Check prices", ja:"ç›¸å ´"} }, { stat: "WLTH", title: {ko:"ì£¼ë§ ì˜ˆì‚°", en:"Budget", ja:"äºˆç®—"}, desc: {ko:"í•œë„ ì„¤ì •", en:"Set limit", ja:"é™åº¦"} }, { stat: "AGI", title: {ko:"ë°€í”„ë ™", en:"Meal Prep", ja:"ä½œã‚Šç½®ã"}, desc: {ko:"ì¬ë£Œ ì†ì§ˆ", en:"Prep food", ja:"æº–å‚™"} }, { stat: "AGI", title: {ko:"ì§‘ì•ˆì¼", en:"Chores", ja:"å®¶äº‹"}, desc: {ko:"ëŒ€ì²­ì†Œ", en:"Cleaning", ja:"æƒé™¤"} } ]
        ];

        let currentDayOfWeek = new Date().getDay(); 
        let questCompletedState = Array.from({length: 7}, () => Array(12).fill(false));

        function renderQuestList() {
            const container = document.getElementById('quest-list-container');
            container.innerHTML = '';
            weeklyQuestData[currentDayOfWeek].forEach((q, idx) => {
                const isDone = questCompletedState[currentDayOfWeek][idx];
                const row = document.createElement('div');
                row.className = `quest-row ${isDone ? 'done' : ''}`;
                row.onclick = () => toggleQuest(idx);

                row.innerHTML = `<div><div class="quest-title"><span class="quest-stat-tag">${q.stat}</span>${q.title[currentLang]}</div><div class="quest-desc">${q.desc[currentLang]}</div></div><div class="quest-checkbox"></div>`;
                container.appendChild(row);
            });
        }

        function toggleQuest(idx) {
            const state = questCompletedState[currentDayOfWeek];
            const q = weeklyQuestData[currentDayOfWeek][idx];
            const sKey = q.stat.toLowerCase();
            
            state[idx] = !state[idx];
            if(state[idx]) { userPoints += 20; pendingStats[sKey] += 0.5; } 
            else { userPoints -= 20; pendingStats[sKey] -= 0.5; }
            
            renderQuestList(); renderCalendar(); updatePointUI(); 
        }

        function renderCalendar() {
            const calGrid = document.getElementById('calendar-grid'); calGrid.innerHTML = '';
            const today = new Date(); const startOfWeek = new Date(today);
            startOfWeek.setDate(today.getDate() - currentDayOfWeek);

            const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            document.getElementById('cal-month').innerText = `${monthNames[startOfWeek.getMonth()]} ${startOfWeek.getFullYear()}`;

            const dayNames = { ko: ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "], en: ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"], ja: ["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"] };

            for (let i = 0; i < 7; i++) {
                const cDate = new Date(startOfWeek); cDate.setDate(startOfWeek.getDate() + i);
                const count = questCompletedState[i].filter(v => v).length;
                const dayDiv = document.createElement('div');
                dayDiv.className = `cal-day ${i === currentDayOfWeek ? 'today' : ''}`;
                dayDiv.innerHTML = `<div class="cal-name">${dayNames[currentLang][i]}</div><div class="cal-date">${cDate.getDate()}</div><div class="cal-score">${count}/12</div>`;
                calGrid.appendChild(dayDiv);
            }
        }

        // --- 6. ì†Œì…œ ë­í‚¹ ---
        let currentSocialMode = 'global'; 
        let currentSortCriteria = 'total';
        const userData = [
            { id: 1, name: "Gwangju_Runner", title: {ko:"ë¬´ë“±ì‚° í˜¸ë‘ì´", en:"Tiger of Mudeung", ja:"ç„¡ç­‰å±±ã®è™"}, str: 95, int: 50, cha: 70, vit: 90, wlth: 30, agi: 85, isMe: false, isFriend: false },
            { id: 2, name: "Camus_Reader", title: {ko:"ì‹¤ì¡´ì£¼ì˜ì", en:"Existentialist", ja:"å®Ÿå­˜ä¸»ç¾©è€…"}, str: 30, int: 98, cha: 50, vit: 40, wlth: 60, agi: 40, isMe: false, isFriend: true },
            { id: 3, name: {ko:"í”Œë ˆì´ì–´ (ë‚˜)", en:"Player (Me)", ja:"ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ (ç§)"}, title: titleHistory[0].title, str: myStats.str, int: myStats.int, cha: myStats.cha, vit: myStats.vit, wlth: myStats.wlth, agi: myStats.agi, isMe: true, isFriend: false },
            { id: 4, name: "GangnamBabel", title: {ko:"êµ­ê°€ê¶Œë ¥ê¸‰ ìë³¸", en:"S-Class Wealth", ja:"å›½å®¶æ¨©åŠ›ç´š è³‡æœ¬"}, str: 60, int: 80, cha: 90, vit: 50, wlth: 99, agi: 50, isMe: false, isFriend: false }
        ];

        function toggleSocialMode(mode, btn) {
            currentSocialMode = mode;
            document.querySelectorAll('.social-tab-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active');
            document.getElementById('ranking-controls').style.display = mode === 'global' ? 'flex' : 'none';
            renderUsers(currentSortCriteria);
        }

        function renderUsers(criteria, btn = null) {
            if(btn) {
                currentSortCriteria = criteria;
                document.querySelectorAll('.rank-tab-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active');
            }
            const container = document.getElementById('user-list-container'); container.innerHTML = '';
            
            const me = userData.find(u => u.isMe);
            if(me) {
                statKeys.forEach(k => me[k] = myStats[k]);
                const savedName = localStorage.getItem('playerName');
                if(savedName) me.name = savedName;
            }
            userData.forEach(u => u.total = u.str + u.int + u.cha + u.vit + u.wlth + u.agi);

            let dUsers = [...userData];
            if(currentSocialMode === 'friends') dUsers = dUsers.filter(u => u.isFriend);
            dUsers.sort((a, b) => b[criteria] - a[criteria]);

            if(dUsers.length === 0) { container.innerHTML = `<div style="text-align:center; padding:20px; color:var(--text-sub);">${i18n[currentLang].no_friend}</div>`; return; }

            dUsers.forEach((user, i) => {
                const card = document.createElement('div'); card.className = `user-card ${user.isMe ? 'my-rank' : ''}`;
                const rDisp = currentSocialMode === 'global' ? `<div style="font-size:1.1rem; font-weight:bold; color:var(--text-sub); width:25px; text-align:center;">${i+1}</div>` : '';
                let fBtn = '';
                if(!user.isMe) fBtn = user.isFriend ? `<button class="btn-friend added" onclick="toggleFriend(${user.id})">${i18n[currentLang].btn_added}</button>` : `<button class="btn-friend" onclick="toggleFriend(${user.id})">${i18n[currentLang].btn_add}</button>`;
                
                const tDisp = user.isMe ? titleHistory[titleHistory.length-1].title[currentLang] : (typeof user.title === 'object' ? user.title[currentLang] : user.title);
                const nDisp = typeof user.name === 'object' ? user.name[currentLang] : user.name;

                card.innerHTML = `${rDisp}<div class="user-info"><div class="title-badge">${tDisp}</div><div style="font-size: 0.95rem;">${nDisp}</div></div><div class="user-score">${user[criteria]}</div>${fBtn}`;
                container.appendChild(card);
            });
        }
        function toggleFriend(id) { const u = userData.find(x => x.id === id); if(u) { u.isFriend = !u.isFriend; renderUsers(currentSortCriteria); } }

        // --- GPS ë¡œì§ ---
        function toggleGPS() {
            const isChecked = document.getElementById('gps-toggle').checked;
            const statusDiv = document.getElementById('gps-status'); statusDiv.style.display = 'flex';
            if(isChecked) {
                statusDiv.innerHTML = '...';
                if ("geolocation" in navigator) navigator.geolocation.getCurrentPosition(() => statusDiv.innerHTML = `<span style="color:var(--neon-blue);">${i18n[currentLang].gps_on}</span>`, () => { statusDiv.innerHTML = `<span style="color:var(--neon-red);">${i18n[currentLang].gps_err}</span>`; document.getElementById('gps-toggle').checked = false; });
            } else statusDiv.innerHTML = `<span style="color:var(--text-sub);">${i18n[currentLang].gps_off}</span>`;
        }

        // ì´ˆê¸° êµ¬ë™ - ì–¸ì–´ ì„¸íŒ… í›„ ë¡œê·¸ì¸ ì²´í¬
        window.onload = () => {
            changeLanguage('ko'); 
            checkLoginStatus(); 
        };
    </script>
</body>
</html>
